<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transformation Sessions - Coaching Command Center</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            min-height: 100vh;
            color: #ffffff;
            display: flex;
            flex-direction: column;
        }

        /* Back Button */
        .back-button {
            position: fixed;
            top: 30px;
            left: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        .back-arrow {
            font-size: 18px;
        }

        /* Header */
        .dashboard-header {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 80px;
            padding-bottom: 20px;
        }

        .dashboard-title {
            font-size: 48px;
            font-weight: bold;
            background: linear-gradient(135deg, #4ecdc4 0%, #44a8b3 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .dashboard-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 18px;
            font-style: italic;
        }

        /* Main Container */
        .main-content {
            flex: 1;
            padding: 0 20px 40px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 40px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-hidden {
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ecdc4, #44a8b3);
            border-radius: 3px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .step-indicator {
            text-align: center;
            margin-bottom: 30px;
        }

        .step-indicator h2 {
            margin-bottom: 5px;
        }

        .step-indicator p {
            color: #b8b8b8;
        }

        .stack-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stack-card {
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .stack-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
            border-color: #4ecdc4;
        }

        .stack-card.selected {
            background: rgba(78, 205, 196, 0.2);
            border-color: #4ecdc4;
            transform: scale(1.05);
        }

        .stack-card h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            color: #ffffff;
        }

        .stack-card .icon {
            font-size: 1.5em;
        }

        .stack-card .description {
            color: #b8b8b8;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .stack-card .steps {
            color: #4ecdc4;
            font-weight: bold;
            font-size: 0.85em;
        }

        .stack-step {
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .question-prompt {
            margin-bottom: 20px;
        }

        .question-prompt p {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .previous-answer {
            color: #4ecdc4;
            font-style: italic;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #ffffff;
            font-size: 1em;
            resize: vertical;
            transition: all 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: #4ecdc4;
            background: rgba(255, 255, 255, 0.08);
        }

        textarea::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 30px;
            justify-content: space-between;
        }

        button {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4ecdc4, #44a8b3);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(78, 205, 196, 0.3);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .completion-message {
            text-align: center;
            padding: 40px;
        }

        .completion-message h2 {
            color: #4ecdc4;
            margin-bottom: 20px;
        }

        .completion-message p {
            color: #b8b8b8;
            margin-bottom: 30px;
        }

        .save-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: rgba(78, 205, 196, 0.9);
            color: white;
            border-radius: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .save-indicator.show {
            opacity: 1;
        }

        /* Footer */
        .footer {
            background: linear-gradient(135deg, #1a1a2e 0%, #0a0a0f 100%);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: auto;
            padding: 3rem 2rem 2rem;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-section h4 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .footer-section p {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.5rem;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.6);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: #667eea;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.85rem;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .back-button {
                top: 15px;
                left: 15px;
                padding: 10px 20px;
                font-size: 14px;
            }

            .dashboard-title {
                font-size: 36px;
            }

            .dashboard-header {
                padding-top: 70px;
            }

            .form-section {
                padding: 25px;
            }

            .stack-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Back to Dashboard Button -->
    <button class="back-button" onclick="goBackToDashboard()">
        <span class="back-arrow">←</span>
        <span>Back to Dashboard</span>
    </button>

    <!-- Save Indicator -->
    <div class="save-indicator" id="saveIndicator">Auto-saved</div>

    <!-- Header -->
    <div class="dashboard-header">
        <h1 class="dashboard-title">Transformation Sessions</h1>
        <p class="dashboard-subtitle">Transform your thoughts into action through structured processing</p>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <form id="stack-form">
            
            <!-- Section 1: Session Type Selection -->
            <div id="section-stack-selection" class="form-section">
                <!-- User Information Section -->
                <div id="user-info-section" style="margin-bottom: 40px; padding: 25px; background: rgba(255, 255, 255, 0.03); border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <h3 style="margin-bottom: 20px; color: #4ecdc4;">Session Information</h3>
                    
                    <!-- Logged-in User Display -->
                    <div id="logged-in-display" style="display: none; margin-bottom: 20px;">
                        <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: rgba(78, 205, 196, 0.1); border-radius: 10px;">
                            <div style="font-size: 2em;">👤</div>
                            <div>
                                <div style="font-weight: 600; color: #ffffff; font-size: 1.1em;" id="display-name">User Name</div>
                                <div style="color: #b8b8b8; font-size: 0.9em;" id="display-email">user@email.com</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Manual Entry Form -->
                    <div id="manual-entry-form">
                        <div id="error-message" style="display: none; background: rgba(255, 67, 54, 0.2); border: 1px solid #ff4336; 
                                                        color: #ff8a80; padding: 12px; border-radius: 8px; margin-bottom: 20px;">
                            <strong>Please fill in all required fields</strong>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: #b8b8b8; font-size: 0.9em;">
                                    Name <span style="color: #ff4336;">*</span>
                                </label>
                                <input type="text" id="user-name" name="user_name" required
                                       class="required-field"
                                       style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.05); 
                                              border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; 
                                              color: white;" placeholder="Your name (required)">
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: #b8b8b8; font-size: 0.9em;">
                                    Email <span style="color: #ff4336;">*</span>
                                </label>
                                <input type="email" id="user-email" name="user_email" required
                                       class="required-field"
                                       style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.05); 
                                              border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; 
                                              color: white;" placeholder="your@email.com (required)">
                            </div>
                        </div>
                        
                        <p style="margin-top: 15px; color: #b8b8b8; font-size: 0.85em;">
                            <span style="color: #ff4336;">*</span> Required fields
                        </p>
                    </div>
                    
                    <!-- Energy Level (always visible) -->
                    <div style="margin-top: 20px;">
                        <label style="display: block; margin-bottom: 5px; color: #b8b8b8; font-size: 0.9em;">
                            Current Energy Level (1-10) <span style="color: #4ecdc4;">Optional</span>
                        </label>
                        <input type="number" id="energy-level" name="energy_level" min="1" max="10" 
                               style="width: 100%; max-width: 300px; padding: 10px; background: rgba(255, 255, 255, 0.05); 
                                      border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; 
                                      color: white;" placeholder="How's your energy? (1-10)">
                    </div>
                </div>

                <h2>Choose Your Session Type</h2>
                <p style="margin-bottom: 30px; color: #b8b8b8;">Select the session that best matches your current need:</p>
                
                <div class="stack-grid">
                    <div class="stack-card" data-stack="prayer">
                        <h3><span class="icon">🙏</span> Prayer Session</h3>
                        <div class="description">Connect with divine guidance and spiritual wisdom.</div>
                        <div class="steps">9 transformative steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="gratitude">
                        <h3><span class="icon">💛</span> Gratitude Session</h3>
                        <div class="description">Lift your spirit and appreciate your progression.</div>
                        <div class="steps">8 appreciation steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="happy">
                        <h3><span class="icon">😊</span> Happy Session</h3>
                        <div class="description">Celebrate wins and extract positive lessons.</div>
                        <div class="steps">8 celebration steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="angry">
                        <h3><span class="icon">😤</span> Angry Session</h3>
                        <div class="description">Transform anger into strategic action.</div>
                        <div class="steps">8 processing steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="war">
                        <h3><span class="icon">⚔️</span> War/Action Session</h3>
                        <div class="description">Transform ideas into actionable plans.</div>
                        <div class="steps">7 strategic steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="discover">
                        <h3><span class="icon">🔍</span> Discover Session</h3>
                        <div class="description">Extract wisdom from learning experiences.</div>
                        <div class="steps">5 exploratory steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="open">
                        <h3><span class="icon">🌟</span> Open Session</h3>
                        <div class="description">Freestyle format for custom processing.</div>
                        <div class="steps">Flexible format</div>
                    </div>
                </div>
                
                <input type="hidden" id="selected-stack" name="stack_type" value="">
                
                <div class="button-group">
                    <button type="button" class="btn-primary" id="start-stack-btn" disabled>
                        Begin Session
                    </button>
                </div>
            </div>

            <!-- PRAYER SESSION (9 steps) -->
            <div id="section-prayer-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="prayer-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Prayer Session</h2>
                    <p>Step <span id="prayer-step-number">1</span> of 9</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <!-- Step 1: Session Title -->
                <div id="prayer-step-1" class="stack-step">
                    <div style="background: rgba(78, 205, 196, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #4ecdc4; margin-bottom: 15px;">🙏 Prayer Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Prayer Session is designed to deepen your spiritual connection and align your actions with divine purpose. 
                            This 9-step process helps you move from confusion to clarity through prayer and revelation.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>Facing difficult decisions requiring divine guidance</li>
                            <li>Feeling disconnected from your spiritual purpose</li>
                            <li>Needing strength to overcome challenges</li>
                            <li>Expressing gratitude and seeking direction</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #4ecdc4; margin-left: 20px;">
                            <li>✓ Clear divine insight or revelation</li>
                            <li>✓ Renewed spiritual connection</li>
                            <li>✓ Specific action steps aligned with your soul purpose</li>
                            <li>✓ Peace and clarity about your situation</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this prayer session?</strong></p>
                    </div>
                    <textarea name="prayer_title" placeholder="Give this prayer session a meaningful title..."></textarea>
                </div>

                <!-- Step 2: Prayer Subject -->
                <div id="prayer-step-2" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Who or what are you stacking?</strong></p>
                        <p style="color: #b8b8b8;">What/who prompted you to pray - could be a person, situation, challenge, or blessing.</p>
                    </div>
                    <textarea name="prayer_subject" placeholder="Describe who or what brought you to prayer..."></textarea>
                </div>

                <!-- Step 3: Prayer Trigger -->
                <div id="prayer-step-3" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>About "<span class="previous-answer" id="prayer-subject-preview"></span>"</p>
                        <p><strong>In this moment, why has this triggered you to pray?</strong></p>
                    </div>
                    <textarea name="prayer_trigger" placeholder="What about this situation calls you to prayer..."></textarea>
                </div>

                <!-- Step 4: Situation Story -->
                <div id="prayer-step-4" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the story you're telling yourself, created by this trigger, about the situation?</strong></p>
                    </div>
                    <textarea name="prayer_story" placeholder="Share your interpretation of the circumstances..."></textarea>
                </div>

                <!-- Step 5: Emotional Response -->
                <div id="prayer-step-5" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Describe the single word feelings that arise for you when you tell yourself that story?</strong></p>
                    </div>
                    <textarea name="prayer_feelings" placeholder="Name your emotions (grateful, worried, excited, humble, etc.)..."></textarea>
                </div>

                <!-- Step 6: Want God to Know -->
                <div id="prayer-step-6" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Complete this multiple times: "I want GOD to know..."</strong></p>
                        <p style="color: #b8b8b8;">Keep going until you've shared everything on your heart.</p>
                    </div>
                    <textarea name="prayer_want_god_know" style="min-height: 200px;" placeholder="I want GOD to know...
I want GOD to know...
I want GOD to know...
I want GOD to know..."></textarea>
                </div>

                <!-- Step 7: Prayer -->
                <div id="prayer-step-7" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Dear GOD,</strong></p>
                        <p style="color: #b8b8b8;">Speak directly to God. Express gratitude, ask for guidance, share concerns, seek strength.</p>
                    </div>
                    <textarea name="prayer_to_god" style="min-height: 250px;" placeholder="Dear GOD..."></textarea>
                </div>

                <!-- Step 8: Life Lesson -->
                <div id="prayer-step-8" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the singular lesson on life you are taking from this prayer session?</strong></p>
                    </div>
                    <textarea name="prayer_lesson" placeholder="The key insight or principle I'm learning..."></textarea>
                </div>

                <!-- Step 9: Revelation & Commitment -->
                <div id="prayer-step-9" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the most significant revelation or insight you are leaving this prayer session with, and why do you feel that way?</strong></p>
                    </div>
                    <textarea name="prayer_revelation" placeholder="My divine insight or understanding..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>What immediate actions are you committed to taking leaving this session?</strong></p>
                    </div>
                    <textarea name="prayer_commitment" placeholder="I commit to..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="previousStep('prayer')" id="prayer-prev-btn" style="display: none;">Previous</button>
                    <button type="button" class="btn-primary" onclick="nextStep('prayer')" id="prayer-next-btn">Next Step</button>
                </div>
            </div>

            <!-- GRATITUDE SESSION (8 steps) -->
            <div id="section-gratitude-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="gratitude-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Gratitude Session</h2>
                    <p>Step <span id="gratitude-step-number">1</span> of 8</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <!-- Step 1: Session Title -->
                <div id="gratitude-step-1" class="stack-step">
                    <div style="background: rgba(255, 193, 7, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #ffc107; margin-bottom: 15px;">💛 Gratitude Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Gratitude Session helps you cultivate appreciation and recognize the abundance in your life. 
                            This 8-step process transforms your perspective and energizes you through gratitude.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>Need to shift from negative to positive energy</li>
                            <li>Want to acknowledge progress and blessings</li>
                            <li>Feeling down and need a perspective shift</li>
                            <li>Want to strengthen your gratitude practice</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #ffc107; margin-left: 20px;">
                            <li>✔ Elevated mood and energy</li>
                            <li>✔ Deeper appreciation for your journey</li>
                            <li>✔ Recognition of overlooked blessings</li>
                            <li>✔ Renewed motivation and inspiration</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this gratitude session?</strong></p>
                    </div>
                    <textarea name="gratitude_title" placeholder="Give this gratitude session a meaningful title..."></textarea>
                </div>

                <!-- Step 2: Three Grateful Things -->
                <div id="gratitude-step-2" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>List three things you're grateful for right now.</strong></p>
                        <p style="color: #b8b8b8;">Be specific and really feel the appreciation.</p>
                    </div>
                    <textarea name="gratitude_three_things" placeholder="1. 
2. 
3. "></textarea>
                </div>

                <!-- Step 3: Person You're Grateful For -->
                <div id="gratitude-step-3" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Who is someone you're deeply grateful for and why?</strong></p>
                    </div>
                    <textarea name="gratitude_person" placeholder="Person and why you're grateful for them..."></textarea>
                </div>

                <!-- Step 4: Recent Win -->
                <div id="gratitude-step-4" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What's a recent win or positive experience you're grateful for?</strong></p>
                    </div>
                    <textarea name="gratitude_win" placeholder="Describe the win and why it matters..."></textarea>
                </div>

                <!-- Step 5: Challenge That Served You -->
                <div id="gratitude-step-5" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What challenge or difficulty are you grateful for because of how it's served your growth?</strong></p>
                    </div>
                    <textarea name="gratitude_challenge" placeholder="The challenge and the growth it created..."></textarea>
                </div>

                <!-- Step 6: Body Appreciation -->
                <div id="gratitude-step-6" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What about your body, health, or physical capabilities are you grateful for?</strong></p>
                    </div>
                    <textarea name="gratitude_body" placeholder="Physical blessings you appreciate..."></textarea>
                </div>

                <!-- Step 7: Opportunity Appreciation -->
                <div id="gratitude-step-7" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What opportunity in your life are you most grateful for right now?</strong></p>
                    </div>
                    <textarea name="gratitude_opportunity" placeholder="Current or upcoming opportunity you appreciate..."></textarea>
                </div>

                <!-- Step 8: Gratitude Declaration -->
                <div id="gratitude-step-8" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Complete this gratitude declaration: "I am grateful for my life because..."</strong></p>
                    </div>
                    <textarea name="gratitude_declaration" style="min-height: 200px;" placeholder="I am grateful for my life because..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>How will you carry this gratitude forward today?</strong></p>
                    </div>
                    <textarea name="gratitude_commitment" placeholder="Actions to maintain this grateful energy..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="previousStep('gratitude')" id="gratitude-prev-btn" style="display: none;">Previous</button>
                    <button type="button" class="btn-primary" onclick="nextStep('gratitude')" id="gratitude-next-btn">Next Step</button>
                </div>
            </div>

            <!-- HAPPY SESSION (8 steps) -->
            <div id="section-happy-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="happy-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Happy Session</h2>
                    <p>Step <span id="happy-step-number">1</span> of 8</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <!-- Step 1: Title -->
                <div id="happy-step-1" class="stack-step">
                    <div style="background: rgba(76, 175, 80, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #4caf50; margin-bottom: 15px;">😊 Celebration Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Celebration Session helps you celebrate wins and extract wisdom from positive experiences. This 8-step process 
                            ensures you learn from success, maintain momentum, and amplify what's working in your life.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>You've achieved a win or breakthrough</li>
                            <li>Something wonderful has happened</li>
                            <li>Want to maintain positive momentum</li>
                            <li>Need to remind yourself of your progress</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #4caf50; margin-left: 20px;">
                            <li>✔ Deep appreciation of your success</li>
                            <li>✔ Clear understanding of what created the win</li>
                            <li>✔ Lessons to replicate success</li>
                            <li>✔ Renewed energy and motivation</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this Celebration Session?</strong></p>
                    </div>
                    <textarea name="happy_title" placeholder="Name this celebration..."></textarea>
                </div>

                <!-- Step 2: Happy Trigger -->
                <div id="happy-step-2" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>Celebrating: "<span class="previous-answer" id="happy-title-preview"></span>"</p>
                        <p><strong>What happened and Who triggered you to feel happy?</strong></p>
                    </div>
                    <textarea name="happy_trigger" placeholder="Describe the positive event and person involved..."></textarea>
                </div>

                <!-- Step 3: Current Story -->
                <div id="happy-step-3" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the story you're telling yourself right now about what happened?</strong></p>
                    </div>
                    <textarea name="happy_story" placeholder="Your interpretation of the positive situation..."></textarea>
                </div>

                <!-- Step 4: Positive Feelings -->
                <div id="happy-step-4" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What are the positive feelings you're experiencing because of this story?</strong></p>
                    </div>
                    <textarea name="happy_feelings" placeholder="List emotions like happiness, excitement, appreciation, etc..."></textarea>
                </div>

                <!-- Step 5: Inspired Actions -->
                <div id="happy-step-5" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What initial desires or actions do you notice rise for you with these feelings?</strong></p>
                    </div>
                    <textarea name="happy_actions" placeholder="What you want to do as a result of feeling good..."></textarea>
                </div>

                <!-- Step 6: Life Lesson -->
                <div id="happy-step-6" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the singular simple lesson on life you're learning from this celebration?</strong></p>
                    </div>
                    <textarea name="happy_lesson" placeholder="Key insight from this positive experience..."></textarea>
                </div>

                <!-- Step 7: Evidence -->
                <div id="happy-step-7" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What evidence do you have to support this story as absolutely true?</strong></p>
                    </div>
                    <textarea name="happy_evidence" placeholder="Facts that confirm your positive interpretation..."></textarea>
                </div>

                <!-- Step 8: Final Insights -->
                <div id="happy-step-8" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What are the FINAL INSIGHTS or REVELATIONS that you're leaving this session with?</strong></p>
                    </div>
                    <textarea name="happy_insights" placeholder="Deeper understanding and takeaways..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>What immediate actions are you committed to taking?</strong></p>
                    </div>
                    <textarea name="happy_commitment" placeholder="How you'll maintain this momentum..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="previousStep('happy')" id="happy-prev-btn" style="display: none;">Previous</button>
                    <button type="button" class="btn-primary" onclick="nextStep('happy')" id="happy-next-btn">Next Step</button>
                </div>
            </div>

            <!-- ANGRY SESSION (8 steps) -->
            <div id="section-angry-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="angry-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Angry Session</h2>
                    <p>Step <span id="angry-step-number">1</span> of 8</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <!-- Step 1: Title -->
                <div id="angry-step-1" class="stack-step">
                    <div style="background: rgba(244, 67, 54, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #f44336; margin-bottom: 15px;">😤 Anger Processing Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Anger Processing session transforms rage and irritation into strategic action. This 8-step process helps you 
                            process negative emotions, separate facts from feelings, and create empowering narratives that serve your goals.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>Someone or something has triggered your anger</li>
                            <li>Feeling frustrated and need clarity</li>
                            <li>Want to convert destructive emotions into productive action</li>
                            <li>Need to reframe a situation strategically</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #f44336; margin-left: 20px;">
                            <li>✔ Release of emotional charge</li>
                            <li>✔ Clear distinction between facts and feelings</li>
                            <li>✔ New empowering story that serves you</li>
                            <li>✔ Strategic action plan from a place of power</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this processing session?</strong></p>
                    </div>
                    <textarea name="angry_title" placeholder="Name this processing session..."></textarea>
                </div>

                <!-- Step 2: Trigger Person -->
                <div id="angry-step-2" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>Processing: "<span class="previous-answer" id="angry-title-preview"></span>"</p>
                        <p><strong>Who has triggered you to feel angry?</strong></p>
                    </div>
                    <textarea name="angry_person" placeholder="Name of person who triggered you..."></textarea>
                </div>

                <!-- Step 3: Current Story -->
                <div id="angry-step-3" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>About "<span class="previous-answer" id="angry-person-preview"></span>"</p>
                        <p><strong>What is the story you're telling yourself right now about what happened?</strong></p>
                    </div>
                    <textarea name="angry_story" placeholder="Your current interpretation of the situation..."></textarea>
                </div>

                <!-- Step 4: Negative Feelings -->
                <div id="angry-step-4" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What are the negative feelings that you're experiencing because of this story?</strong></p>
                    </div>
                    <textarea name="angry_feelings" placeholder="List your current emotions - anger, frustration, etc..."></textarea>
                </div>

                <!-- Step 5: Facts -->
                <div id="angry-step-5" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What are the FACTS (without FEELINGS) about the situation?</strong></p>
                        <p style="color: #b8b8b8;">Objective description of what actually happened.</p>
                    </div>
                    <textarea name="angry_facts" placeholder="Just the facts, no interpretation..."></textarea>
                </div>

                <!-- Step 6: True Desire -->
                <div id="angry-step-6" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Beyond the trigger of this situation, what do you truly want for YOU?</strong></p>
                    </div>
                    <textarea name="angry_desire" placeholder="What you actually want to achieve or experience..."></textarea>
                </div>

                <!-- Step 7: Strategic Story -->
                <div id="angry-step-7" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is a more strategic story that you could create to assure you get what you truly want?</strong></p>
                    </div>
                    <textarea name="angry_new_story" placeholder="A new interpretation that serves your goals..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>How does this new strategic story make you feel?</strong></p>
                    </div>
                    <textarea name="angry_new_feelings" placeholder="Emotional response to your new perspective..."></textarea>
                </div>

                <!-- Step 8: Insight & Action -->
                <div id="angry-step-8" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the singular, simple lesson on life you're learning from this anger processing?</strong></p>
                    </div>
                    <textarea name="angry_lesson" placeholder="Core lesson for life application..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>What action do you feel called to take?</strong></p>
                    </div>
                    <textarea name="angry_action" placeholder="Specific action you'll take as a result..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="previousStep('angry')" id="angry-prev-btn" style="display: none;">Previous</button>
                    <button type="button" class="btn-primary" onclick="nextStep('angry')" id="angry-next-btn">Next Step</button>
                </div>
            </div>

            <!-- WAR/ACTION SESSION (7 steps) -->
            <div id="section-war-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="war-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>War/Action Session</h2>
                    <p>Step <span id="war-step-number">1</span> of 7</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <!-- Step 1: Title -->
                <div id="war-step-1" class="stack-step">
                    <div style="background: rgba(255, 107, 107, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #ff6b6b; margin-bottom: 15px;">⚔️ WAR/Action Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The WAR Session transforms productive ideas into actionable battle plans. This 7-step process helps you 
                            evaluate opportunities, identify obstacles, and create measurable facts (action steps) to execute your vision.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>You have a new business or life idea to develop</li>
                            <li>Need to turn inspiration into concrete action</li>
                            <li>Want to evaluate if an opportunity is worth pursuing</li>
                            <li>Ready to overcome obstacles and execute</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #ff6b6b; margin-left: 20px;">
                            <li>✔ Clear evaluation of your idea's potential</li>
                            <li>✔ Three specific, measurable action steps (FACTS)</li>
                            <li>✔ Identified obstacles with solutions</li>
                            <li>✔ Commitment to immediate execution</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this WAR/Action Session?</strong></p>
                    </div>
                    <textarea name="war_title" placeholder="Give your idea a powerful title..."></textarea>
                </div>

                <!-- Step 2: Source -->
                <div id="war-step-2" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>Your idea: "<span class="previous-answer" id="war-title-preview"></span>"</p>
                        <p><strong>Who/What are you stacking?</strong></p>
                        <p style="color: #b8b8b8;">Person, situation, or source that sparked the idea.</p>
                    </div>
                    <textarea name="war_source" placeholder="What or who triggered this idea..."></textarea>
                </div>

                <!-- Step 3: Idea Description -->
                <div id="war-step-3" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>Based on "<span class="previous-answer" id="war-source-preview"></span>"</p>
                        <p><strong>In this moment, what Idea has this activated in you?</strong></p>
                    </div>
                    <textarea name="war_idea" placeholder="Describe the specific idea or opportunity..."></textarea>
                </div>

                <!-- Step 4: Story -->
                <div id="war-step-4" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the story you're telling yourself about this new idea?</strong></p>
                    </div>
                    <textarea name="war_story" placeholder="Your interpretation and vision for this idea..."></textarea>
                </div>

                <!-- Step 5: Feelings -->
                <div id="war-step-5" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Describe the single word feelings that arise for you when you tell yourself that story?</strong></p>
                    </div>
                    <textarea name="war_feelings" placeholder="Primary emotions (excited, curious, motivated, etc.)..."></textarea>
                </div>

                <!-- Step 6: Benefits -->
                <div id="war-step-6" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>If this productive idea is executed on, what are the positive benefits to your world and those you are connected to?</strong></p>
                    </div>
                    <textarea name="war_benefits" placeholder="How success would impact you and others..."></textarea>
                </div>

                <!-- Step 7: Action Plan -->
                <div id="war-step-7" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What are your first THREE measurable FACTS (action steps)?</strong></p>
                        <p style="color: #b8b8b8;">List specific, actionable steps with potential obstacles and solutions.</p>
                    </div>
                    <textarea name="war_facts" style="min-height: 250px;" placeholder="FACT 1: [Specific action]
Why it's important: 
Potential obstacles: 
How to overcome: 

FACT 2: [Specific action]
Why it's important: 
Potential obstacles: 
How to overcome: 

FACT 3: [Specific action]
Why it's important: 
Potential obstacles: 
How to overcome: "></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>What immediate actions are you committed to taking?</strong></p>
                    </div>
                    <textarea name="war_commitment" placeholder="Your immediate next steps..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="previousStep('war')" id="war-prev-btn" style="display: none;">Previous</button>
                    <button type="button" class="btn-primary" onclick="nextStep('war')" id="war-next-btn">Next Step</button>
                </div>
            </div>

            <!-- DISCOVER SESSION (5 steps) -->
            <div id="section-discover-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="discover-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Discover Session</h2>
                    <p>Step <span id="discover-step-number">1</span> of 5</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <!-- Step 1: Title -->
                <div id="discover-step-1" class="stack-step">
                    <div style="background: rgba(156, 39, 176, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #9c27b0; margin-bottom: 15px;">🔍 Discovery Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Discovery Session extracts wisdom from learning experiences and turns insights into practical application. 
                            This 5-step process helps you capture revelations from books, training, conversations, or personal experiences.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>You've learned something significant from a book or course</li>
                            <li>Had an important realization or "aha" moment</li>
                            <li>Want to apply new knowledge to your life</li>
                            <li>Need to process and integrate learning</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #9c27b0; margin-left: 20px;">
                            <li>✔ Clear articulation of your discovery</li>
                            <li>✔ Understanding of why it matters to you</li>
                            <li>✔ Practical application to your life</li>
                            <li>✔ Immediate action steps to implement</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this Discovery Session?</strong></p>
                    </div>
                    <textarea name="discover_title" placeholder="Name this discovery session..."></textarea>
                </div>

                <!-- Step 2: Source -->
                <div id="discover-step-2" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>Discovery: "<span class="previous-answer" id="discover-title-preview"></span>"</p>
                        <p><strong>What resource(s) were you studying today?</strong></p>
                        <p style="color: #b8b8b8;">Book, course, person, experience, or situation that provided the insight.</p>
                    </div>
                    <textarea name="discover_source" placeholder="Book, course, person, experience..."></textarea>
                </div>

                <!-- Step 3: Discovery Content -->
                <div id="discover-step-3" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>From "<span class="previous-answer" id="discover-source-preview"></span>"</p>
                        <p><strong>What did you discover during your study session?</strong></p>
                        <p style="color: #b8b8b8;">The specific insight, principle, or revelation you gained.</p>
                    </div>
                    <textarea name="discover_content" placeholder="The specific insight or revelation..."></textarea>
                </div>

                <!-- Step 4: Story & Significance -->
                <div id="discover-step-4" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the story you're telling yourself about this discovery?</strong></p>
                    </div>
                    <textarea name="discover_story" placeholder="How you interpret and relate to this discovery..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>Why do you feel this specific discovery was significant?</strong></p>
                    </div>
                    <textarea name="discover_significance" placeholder="Why this insight matters to you..."></textarea>
                </div>

                <!-- Step 5: Application -->
                <div id="discover-step-5" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the singular, simple lesson on life you're learning from this Discovery Session?</strong></p>
                    </div>
                    <textarea name="discover_lesson" placeholder="The essential principle or truth you've learned..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>What immediate actions are you committed to taking leaving this session?</strong></p>
                    </div>
                    <textarea name="discover_commitment" placeholder="Specific steps you'll take to implement this discovery..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="previousStep('discover')" id="discover-prev-btn" style="display: none;">Previous</button>
                    <button type="button" class="btn-primary" onclick="nextStep('discover')" id="discover-next-btn">Next Step</button>
                </div>
            </div>

            <!-- OPEN SESSION -->
            <div id="section-open-stack" class="form-section section-hidden">
                <div class="step-indicator">
                    <h2>Open Session</h2>
                    <p>Freestyle Format</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <div class="stack-step">
                    <div style="background: rgba(33, 150, 243, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #2196f3; margin-bottom: 15px;">🌟 Open Format Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Open Format is your freestyle session for custom processing. This flexible approach lets you create 
                            your own structure for reflection, analysis, or any situation that doesn't fit the other session types.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>Need a "Working/Not Working" analysis</li>
                            <li>Want to do weekly or monthly reflection</li>
                            <li>Creating custom gratitude or growth sessions</li>
                            <li>Exploring something unique to your situation</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Popular Formats:</strong></p>
                        <ul style="color: #2196f3; margin-left: 20px;">
                            <li>✔ Working/Not Working Analysis</li>
                            <li>✔ Start/Stop/Continue Framework</li>
                            <li>✔ Weekly Wins & Lessons</li>
                            <li>✔ Gratitude and Growth Reflection</li>
                            <li>✔ Core 4 Domain Review</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this Open Session?</strong></p>
                    </div>
                    <textarea name="open_title" placeholder="Name your freestyle session..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 30px;">
                        <p><strong>Time to freestyle your own session. 3-2-1 off you go...</strong></p>
                        <p style="color: #b8b8b8; margin-top: 10px;">Choose from the templates below or create your own structure:</p>
                    </div>
                    <textarea name="open_content" style="min-height: 400px;" placeholder="TEMPLATE 1: Working/Not Working
=====================================
WORKING:
- 
- 
- 

NOT WORKING:
- 
- 
- 

ACTIONS TO AMPLIFY WHAT'S WORKING:
- 
- 

ACTIONS TO FIX WHAT'S NOT:
- 
- 


TEMPLATE 2: Weekly Reflection
=====================================
THIS WEEK'S WINS:
- 
- 

KEY LESSONS LEARNED:
- 
- 

NEXT WEEK'S FOCUS:
- 
- 


Or create your own structure..."></textarea>
                </div>
                
                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="backToSelection()">Back to Selection</button>
                    <button type="button" class="btn-primary" onclick="completeOpenStack()">Complete Session</button>
                </div>
            </div>

            <!-- Completion Section -->
            <div id="section-completion" class="form-section section-hidden">
                <div class="completion-message">
                    <h2>🎉 Session Complete!</h2>
                    <p>Your session has been recorded and sent to processing.</p>
                    <p>Thank you for taking the time to process and grow.</p>
                    
                    <div class="button-group" style="justify-content: center;">
                        <button type="button" class="btn-primary" onclick="startNewSession()">Start New Session</button>
                        <button type="button" class="btn-secondary" onclick="goBackToDashboard()">Return to Dashboard</button>
                    </div>
                </div>
            </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Transformation Sessions</h4>
                <p>Structured processing frameworks to transform thoughts into action and extract wisdom from every experience.</p>
            </div>
            <div class="footer-section">
                <h4>Quick Navigation</h4>
                <ul class="footer-links">
                    <li><a href="https://dvries10271.github.io/Coaching_Command_Center/">Main Dashboard</a></li>
                    <li><a href="https://dvries10271.github.io/Analytics-Dashboard/">Analytics Dashboard</a></li>
                    <li><a href="https://dvries10271.github.io/Action-Command-Center/">Action Center</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Session Types</h4>
                <ul class="footer-links">
                    <li><a href="#" onclick="selectStackType('prayer'); return false;">Prayer Session</a></li>
                    <li><a href="#" onclick="selectStackType('gratitude'); return false;">Gratitude Session</a></li>
                    <li><a href="#" onclick="selectStackType('happy'); return false;">Happy Session</a></li>
                    <li><a href="#" onclick="selectStackType('angry'); return false;">Anger Processing</a></li>
                    <li><a href="#" onclick="selectStackType('war'); return false;">War/Action Session</a></li>
                    <li><a href="#" onclick="selectStackType('discover'); return false;">Discovery Session</a></li>
                    <li><a href="#" onclick="selectStackType('open'); return false;">Open Format</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>System Status</h4>
                <div class="status-info" style="display: flex; align-items: center; gap: 0.5rem; color: rgba(255, 255, 255, 0.8); font-size: 0.9rem; margin-bottom: 0.5rem;">
                    <span class="status-dot" style="width: 8px; height: 8px; border-radius: 50%; background: #4caf50; animation: pulse 2s infinite;"></span>
                    <span>Session Module Active</span>
                </div>
                <div style="color: rgba(255, 255, 255, 0.5); font-size: 0.85rem;">
                    Auto-save: Enabled
                </div>
                <div style="color: rgba(255, 255, 255, 0.5); font-size: 0.85rem;" id="footerLastSave">
                    Last saved: Never
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2025 Lead Generation Experts LLC Coaching System. Built With Purpose. All Rights Reserved.</p>
            <p style="margin-top: 0.5rem; font-size: 0.8rem; color: rgba(255, 255, 255, 0.3);">Transformation Sessions v2.0 | Enhanced September 2025</p>
        </div>
    </footer>

    <script>
        // Configuration
        const stackConfigs = {
            prayer: { steps: 9, section: 'prayer-stack' },
            gratitude: { steps: 8, section: 'gratitude-stack' },
            happy: { steps: 8, section: 'happy-stack' },
            angry: { steps: 8, section: 'angry-stack' },
            war: { steps: 7, section: 'war-stack' },
            discover: { steps: 5, section: 'discover-stack' },
            open: { steps: 1, section: 'open-stack' }
        };

        let currentStack = null;
        let currentStep = {};

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Page loaded - initializing...');
            
            // Check for logged-in user
            checkUserAuthentication();
            
            // Initialize step trackers
            Object.keys(stackConfigs).forEach(stack => {
                currentStep[stack] = 1;
            });

            // Load saved data
            loadSavedData();

            // Stack card selection
            document.querySelectorAll('.stack-card').forEach(card => {
                card.addEventListener('click', () => {
                    document.querySelectorAll('.stack-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    currentStack = card.dataset.stack;
                    document.getElementById('selected-stack').value = currentStack;
                    document.getElementById('start-stack-btn').disabled = false;
                    console.log(`Selected stack: ${currentStack}`);
                });
            });

            // Start button
            document.getElementById('start-stack-btn').addEventListener('click', () => {
                if (!validateRequiredFields()) {
                    return;
                }
                
                if (currentStack) {
                    console.log(`Starting ${currentStack} stack`);
                    document.getElementById('section-stack-selection').classList.add('section-hidden');
                    
                    const sectionId = `section-${stackConfigs[currentStack].section}`;
                    const section = document.getElementById(sectionId);
                    if (section) {
                        section.classList.remove('section-hidden');
                        currentStep[currentStack] = 1;
                        updateProgress(currentStack);
                        console.log(`Showing section: ${sectionId}`);
                    } else {
                        console.log(`ERROR: Section not found: ${sectionId}`);
                    }
                }
            });

            // Auto-save all textareas
            document.querySelectorAll('textarea').forEach(textarea => {
                textarea.addEventListener('input', () => {
                    localStorage.setItem(`stack_${textarea.name}`, textarea.value);
                    updatePreviews();
                    showSaveIndicator();
                    console.log(`Saved: ${textarea.name}`);
                });
            });

            // Auto-save all input fields
            document.querySelectorAll('input, select').forEach(input => {
                const savedValue = localStorage.getItem(`stack_${input.name}`);
                if (savedValue) {
                    input.value = savedValue;
                }
                
                input.addEventListener('change', () => {
                    localStorage.setItem(`stack_${input.name}`, input.value);
                    showSaveIndicator();
                });
            });

            console.log('Initialization complete');
        });

        function checkUserAuthentication() {
            const userEmail = localStorage.getItem('coaching_user_email');
            const userData = localStorage.getItem('coaching_user_data');
            
            if (userEmail && userData) {
                try {
                    const user = JSON.parse(userData);
                    console.log('User authenticated: ' + user.name);
                    
                    document.getElementById('manual-entry-form').style.display = 'none';
                    document.getElementById('logged-in-display').style.display = 'block';
                    document.getElementById('display-name').textContent = user.name || 'User';
                    document.getElementById('display-email').textContent = user.email || userEmail;
                    document.getElementById('user-name').value = user.name || 'User';
                    document.getElementById('user-email').value = user.email || userEmail;
                    document.getElementById('user-name').removeAttribute('required');
                    document.getElementById('user-email').removeAttribute('required');
                    document.getElementById('user-name').classList.remove('required-field');
                    document.getElementById('user-email').classList.remove('required-field');
                } catch (error) {
                    console.log('Error parsing user data: ' + error);
                    showManualEntry();
                }
            } else {
                console.log('No user authentication found');
                showManualEntry();
            }
        }

        function showManualEntry() {
            document.getElementById('manual-entry-form').style.display = 'block';
            document.getElementById('logged-in-display').style.display = 'none';
        }

        function showSaveIndicator() {
            const indicator = document.getElementById('saveIndicator');
            indicator.classList.add('show');
            
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            const footerSave = document.getElementById('footerLastSave');
            if (footerSave) {
                footerSave.textContent = 'Last saved: ' + timeString;
            }
            
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }

        function loadSavedData() {
            console.log('Loading saved data from localStorage');
            let loadedCount = 0;
            document.querySelectorAll('textarea').forEach(textarea => {
                const savedValue = localStorage.getItem(`stack_${textarea.name}`);
                if (savedValue) {
                    textarea.value = savedValue;
                    loadedCount++;
                }
            });
            console.log(`Loaded ${loadedCount} saved fields`);
        }

        function updatePreviews() {
            document.querySelectorAll('.previous-answer').forEach(span => {
                const id = span.id;
                if (!id) return;
                
                const fieldName = id.replace('-preview', '').replace(/-/g, '_');
                const sourceTextarea = document.querySelector(`textarea[name="${fieldName}"]`);
                
                if (sourceTextarea && sourceTextarea.value) {
                    const preview = sourceTextarea.value.substring(0, 100);
                    span.textContent = preview + (sourceTextarea.value.length > 100 ? '...' : '');
                }
            });
        }

        function updateProgress(stackType) {
            const progress = (currentStep[stackType] / stackConfigs[stackType].steps) * 100;
            const progressBar = document.getElementById(`${stackType}-progress`);
            if (progressBar) {
                progressBar.style.width = `${progress}%`;
                console.log(`Progress for ${stackType}: ${progress.toFixed(1)}%`);
            }
        }

        function updateStepNumber(stackType) {
            const stepNumber = document.getElementById(`${stackType}-step-number`);
            if (stepNumber) {
                stepNumber.textContent = currentStep[stackType];
            }
        }

        function nextStep(stackType) {
            console.log(`Next step for ${stackType}: ${currentStep[stackType]} -> ${currentStep[stackType] + 1}`);
            const maxSteps = stackConfigs[stackType].steps;
            
            if (currentStep[stackType] < maxSteps) {
                // Hide current step
                const currentStepElement = document.getElementById(`${stackType}-step-${currentStep[stackType]}`);
                if (currentStepElement) {
                    currentStepElement.classList.add('section-hidden');
                }
                
                // Move to next step
                currentStep[stackType]++;
                
                // Show next step
                const nextStepElement = document.getElementById(`${stackType}-step-${currentStep[stackType]}`);
                if (nextStepElement) {
                    nextStepElement.classList.remove('section-hidden');
                }
                
                // Show Previous button after step 1
                const prevBtn = document.getElementById(`${stackType}-prev-btn`);
                if (prevBtn && currentStep[stackType] > 1) {
                    prevBtn.style.display = 'block';
                }
                
                updateProgress(stackType);
                updateStepNumber(stackType);
                updatePreviews();
                
                // Update button for last step
                if (currentStep[stackType] === maxSteps) {
                    const nextBtn = document.getElementById(`${stackType}-next-btn`);
                    if (nextBtn) {
                        nextBtn.textContent = 'Complete Session';
                        nextBtn.onclick = () => completeStack(stackType);
                    }
                }
            }
        }

        function previousStep(stackType) {
            console.log(`Previous step for ${stackType}: ${currentStep[stackType]} -> ${currentStep[stackType] - 1}`);
            
            if (currentStep[stackType] > 1) {
                // Hide current step
                const currentStepElement = document.getElementById(`${stackType}-step-${currentStep[stackType]}`);
                if (currentStepElement) {
                    currentStepElement.classList.add('section-hidden');
                }
                
                // Move to previous step
                currentStep[stackType]--;
                
                // Show previous step
                const prevStepElement = document.getElementById(`${stackType}-step-${currentStep[stackType]}`);
                if (prevStepElement) {
                    prevStepElement.classList.remove('section-hidden');
                }
                
                // Hide Previous button if back at step 1
                const prevBtn = document.getElementById(`${stackType}-prev-btn`);
                if (prevBtn && currentStep[stackType] === 1) {
                    prevBtn.style.display = 'none';
                }
                
                updateProgress(stackType);
                updateStepNumber(stackType);
                
                // Reset button text
                const nextBtn = document.getElementById(`${stackType}-next-btn`);
                if (nextBtn && currentStep[stackType] < stackConfigs[stackType].steps) {
                    nextBtn.textContent = 'Next Step';
                    nextBtn.onclick = () => nextStep(stackType);
                }
            }
        }

        function completeStack(stackType) {
            console.log(`Completing ${stackType} session`);
            
            // Collect all data
            const formData = new FormData(document.getElementById('stack-form'));
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            console.log('Form data collected:', Object.keys(data));
            
            // WEBHOOK SUBMISSION
            submitToWebhook(data);
            
            // Show completion
            document.getElementById(`section-${stackConfigs[stackType].section}`).classList.add('section-hidden');
            document.getElementById('section-completion').classList.remove('section-hidden');
            
            // Clear localStorage for this stack
            clearStackData(stackType);
        }
        
        function completeOpenStack() {
            completeStack('open');
        }

        function submitToWebhook(data) {
            // CRITICAL: This is your webhook URL
            const webhookUrl = 'https://n8n-production-3280.up.railway.app/webhook/stack-form-submit';
            console.log(`WEBHOOK: Submitting to ${webhookUrl}`);
            
            // Add metadata
            const payload = {
                ...data,
                timestamp: new Date().toISOString(),
                user_id: localStorage.getItem('coaching_user_email') || 'web_form_user',
                session_type: currentStack
            };
            
            console.log('WEBHOOK: Sending payload with session_type:', payload.session_type);
            
            fetch(webhookUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(payload)
            })
            .then(response => {
                console.log('WEBHOOK: Response status:', response.status);
                if (response.ok) {
                    console.log('WEBHOOK: Session submitted successfully');
                } else {
                    console.error('WEBHOOK: Error response:', response.status);
                }
                return response.text();
            })
            .then(text => {
                console.log('WEBHOOK: Response text:', text);
            })
            .catch(error => {
                console.error('WEBHOOK ERROR: Failed to submit session:', error);
            });
        }

        function clearStackData(stackType) {
            console.log(`Clearing saved data for ${stackType}`);
            document.querySelectorAll(`textarea[name^="${stackType}_"]`).forEach(textarea => {
                localStorage.removeItem(`stack_${textarea.name}`);
            });
        }

        function validateRequiredFields() {
            const userEmail = localStorage.getItem('coaching_user_email');
            const userData = localStorage.getItem('coaching_user_data');
            
            if (userEmail && userData) {
                console.log('User authenticated - skipping name/email validation');
                return true;
            }
            
            const requiredFields = document.querySelectorAll('.required-field');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    isValid = false;
                    field.style.borderColor = '#ff4336';
                }
            });
            
            if (!isValid) {
                const errorMsg = document.getElementById('error-message');
                if (errorMsg) {
                    errorMsg.style.display = 'block';
                }
                console.log('Validation failed');
            }
            
            return isValid;
        }

        function goBackToDashboard() {
            window.location.href = 'https://dvries10271.github.io/Coaching_Command_Center/';
        }

        function backToSelection() {
            console.log('Returning to session selection');
            document.querySelectorAll('.form-section').forEach(section => {
                section.classList.add('section-hidden');
            });
            document.getElementById('section-stack-selection').classList.remove('section-hidden');
        }

        function selectStackType(stackType) {
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            document.querySelectorAll('.stack-card').forEach(c => c.classList.remove('selected'));
            
            const targetCard = document.querySelector(`[data-stack="${stackType}"]`);
            if (targetCard) {
                targetCard.classList.add('selected');
                currentStack = stackType;
                document.getElementById('selected-stack').value = stackType;
                document.getElementById('start-stack-btn').disabled = false;
                console.log(`Selected stack via footer: ${stackType}`);
            }
        }

        function startNewSession() {
            console.log('Starting new session');
            
            // Reset everything
            currentStack = null;
            Object.keys(stackConfigs).forEach(stack => {
                currentStep[stack] = 1;
            });
            document.getElementById('selected-stack').value = '';
            document.getElementById('start-stack-btn').disabled = true;
            document.querySelectorAll('.stack-card').forEach(c => c.classList.remove('selected'));
            
            // Clear textareas
            document.querySelectorAll('textarea').forEach(t => {
                t.value = '';
                localStorage.removeItem(`stack_${t.name}`);
            });
            
            // Reset all steps
            document.querySelectorAll('.stack-step').forEach((step, index) => {
                if (step.id.endsWith('-step-1')) {
                    step.classList.remove('section-hidden');
                } else {
                    step.classList.add('section-hidden');
                }
            });
            
            // Reset progress bars
            document.querySelectorAll('.progress-fill').forEach(bar => {
                bar.style.width = '0%';
            });
            
            // Show selection screen
            document.getElementById('section-completion').classList.add('section-hidden');
            document.getElementById('section-stack-selection').classList.remove('section-hidden');
        }

        // NOTE: Add the other session sections (gratitude, happy, angry, war, discover, open)
        // with all their steps here following the same pattern as the Prayer session
    </script>
</body>
</html>
```
---
### **File: `complete-transformation-sessions.html` (Completed)**
This is the finished version of the file, which was previously incomplete. It now contains all session types, the footer, and the necessary JavaScript to function as a complete, standalone page.

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transformation Sessions - Coaching Command Center</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            min-height: 100vh;
            color: #ffffff;
            display: flex;
            flex-direction: column;
        }

        /* Back Button */
        .back-button {
            position: fixed;
            top: 30px;
            left: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        .back-arrow {
            font-size: 18px;
        }

        /* Header */
        .dashboard-header {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 80px;
            padding-bottom: 20px;
        }

        .dashboard-title {
            font-size: 48px;
            font-weight: bold;
            background: linear-gradient(135deg, #4ecdc4 0%, #44a8b3 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .dashboard-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 18px;
            font-style: italic;
        }

        /* Main Container */
        .main-content {
            flex: 1;
            padding: 0 20px 40px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 40px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-hidden {
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ecdc4, #44a8b3);
            border-radius: 3px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .step-indicator {
            text-align: center;
            margin-bottom: 30px;
        }

        .step-indicator h2 {
            margin-bottom: 5px;
        }

        .step-indicator p {
            color: #b8b8b8;
        }

        .stack-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stack-card {
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .stack-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
            border-color: #4ecdc4;
        }

        .stack-card.selected {
            background: rgba(78, 205, 196, 0.2);
            border-color: #4ecdc4;
            transform: scale(1.05);
        }

        .stack-card h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            color: #ffffff;
        }

        .stack-card .icon {
            font-size: 1.5em;
        }

        .stack-card .description {
            color: #b8b8b8;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .stack-card .steps {
            color: #4ecdc4;
            font-weight: bold;
            font-size: 0.85em;
        }

        .stack-step {
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .question-prompt {
            margin-bottom: 20px;
        }

        .question-prompt p {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .previous-answer {
            color: #4ecdc4;
            font-style: italic;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #ffffff;
            font-size: 1em;
            resize: vertical;
            transition: all 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: #4ecdc4;
            background: rgba(255, 255, 255, 0.08);
        }

        textarea::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 30px;
            justify-content: space-between;
        }

        button {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4ecdc4, #44a8b3);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(78, 205, 196, 0.3);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .completion-message {
            text-align: center;
            padding: 40px;
        }

        .completion-message h2 {
            color: #4ecdc4;
            margin-bottom: 20px;
        }

        .completion-message p {
            color: #b8b8b8;
            margin-bottom: 30px;
        }

        .save-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: rgba(78, 205, 196, 0.9);
            color: white;
            border-radius: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .save-indicator.show {
            opacity: 1;
        }

        /* Footer */
        .footer {
            background: linear-gradient(135deg, #1a1a2e 0%, #0a0a0f 100%);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: auto;
            padding: 3rem 2rem 2rem;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-section h4 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .footer-section p {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.5rem;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.6);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: #667eea;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.85rem;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .back-button {
                top: 15px;
                left: 15px;
                padding: 10px 20px;
                font-size: 14px;
            }

            .dashboard-title {
                font-size: 36px;
            }

            .dashboard-header {
                padding-top: 70px;
            }

            .form-section {
                padding: 25px;
            }

            .stack-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Back to Dashboard Button -->
    <button class="back-button" onclick="goBackToDashboard()">
        <span class="back-arrow">←</span>
        <span>Back to Dashboard</span>
    </button>

    <!-- Save Indicator -->
    <div class="save-indicator" id="saveIndicator">Auto-saved</div>

    <!-- Header -->
    <div class="dashboard-header">
        <h1 class="dashboard-title">Transformation Sessions</h1>
        <p class="dashboard-subtitle">Transform your thoughts into action through structured processing</p>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <form id="stack-form">
            
            <!-- Section 1: Session Type Selection -->
            <div id="section-stack-selection" class="form-section">
                <!-- User Information Section -->
                <div id="user-info-section" style="margin-bottom: 40px; padding: 25px; background: rgba(255, 255, 255, 0.03); border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <h3 style="margin-bottom: 20px; color: #4ecdc4;">Session Information</h3>
                    
                    <!-- Logged-in User Display -->
                    <div id="logged-in-display" style="display: none; margin-bottom: 20px;">
                        <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: rgba(78, 205, 196, 0.1); border-radius: 10px;">
                            <div style="font-size: 2em;">👤</div>
                            <div>
                                <div style="font-weight: 600; color: #ffffff; font-size: 1.1em;" id="display-name">User Name</div>
                                <div style="color: #b8b8b8; font-size: 0.9em;" id="display-email">user@email.com</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Manual Entry Form -->
                    <div id="manual-entry-form">
                        <div id="error-message" style="display: none; background: rgba(255, 67, 54, 0.2); border: 1px solid #ff4336; 
                                                        color: #ff8a80; padding: 12px; border-radius: 8px; margin-bottom: 20px;">
                            <strong>Please fill in all required fields</strong>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: #b8b8b8; font-size: 0.9em;">
                                    Name <span style="color: #ff4336;">*</span>
                                </label>
                                <input type="text" id="user-name" name="user_name" required
                                       class="required-field"
                                       style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.05); 
                                              border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; 
                                              color: white;" placeholder="Your name (required)">
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: #b8b8b8; font-size: 0.9em;">
                                    Email <span style="color: #ff4336;">*</span>
                                </label>
                                <input type="email" id="user-email" name="user_email" required
                                       class="required-field"
                                       style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.05); 
                                              border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; 
                                              color: white;" placeholder="your@email.com (required)">
                            </div>
                        </div>
                        
                        <p style="margin-top: 15px; color: #b8b8b8; font-size: 0.85em;">
                            <span style="color: #ff4336;">*</span> Required fields
                        </p>
                    </div>
                    
                    <!-- Energy Level (always visible) -->
                    <div style="margin-top: 20px;">
                        <label style="display: block; margin-bottom: 5px; color: #b8b8b8; font-size: 0.9em;">
                            Current Energy Level (1-10) <span style="color: #4ecdc4;">Optional</span>
                        </label>
                        <input type="number" id="energy-level" name="energy_level" min="1" max="10" 
                               style="width: 100%; max-width: 300px; padding: 10px; background: rgba(255, 255, 255, 0.05); 
                                      border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; 
                                      color: white;" placeholder="How's your energy? (1-10)">
                    </div>
                </div>

                <h2>Choose Your Session Type</h2>
                <p style="margin-bottom: 30px; color: #b8b8b8;">Select the session that best matches your current need:</p>
                
                <div class="stack-grid">
                    <div class="stack-card" data-stack="prayer">
                        <h3><span class="icon">🙏</span> Prayer Session</h3>
                        <div class="description">Connect with divine guidance and spiritual wisdom.</div>
                        <div class="steps">9 transformative steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="gratitude">
                        <h3><span class="icon">💛</span> Gratitude Session</h3>
                        <div class="description">Lift your spirit and appreciate your progression.</div>
                        <div class="steps">8 appreciation steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="happy">
                        <h3><span class="icon">😊</span> Happy Session</h3>
                        <div class="description">Celebrate wins and extract positive lessons.</div>
                        <div class="steps">8 celebration steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="angry">
                        <h3><span class="icon">😤</span> Angry Session</h3>
                        <div class="description">Transform anger into strategic action.</div>
                        <div class="steps">8 processing steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="war">
                        <h3><span class="icon">⚔️</span> War/Action Session</h3>
                        <div class="description">Transform ideas into actionable plans.</div>
                        <div class="steps">7 strategic steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="discover">
                        <h3><span class="icon">🔍</span> Discover Session</h3>
                        <div class="description">Extract wisdom from learning experiences.</div>
                        <div class="steps">5 exploratory steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="open">
                        <h3><span class="icon">🌟</span> Open Session</h3>
                        <div class="description">Freestyle format for custom processing.</div>
                        <div class="steps">Flexible format</div>
                    </div>
                </div>
                
                <input type="hidden" id="selected-stack" name="stack_type" value="">
                
                <div class="button-group">
                    <button type="button" class="btn-primary" id="start-stack-btn" disabled>
                        Begin Session
                    </button>
                </div>
            </div>

            <!-- PRAYER SESSION (9 steps) -->
            <div id="section-prayer-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="prayer-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Prayer Session</h2>
                    <p>Step <span id="prayer-step-number">1</span> of 9</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <!-- Step 1: Session Title -->
                <div id="prayer-step-1" class="stack-step">
                    <div style="background: rgba(78, 205, 196, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #4ecdc4; margin-bottom: 15px;">🙏 Prayer Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Prayer Session is designed to deepen your spiritual connection and align your actions with divine purpose. 
                            This 9-step process helps you move from confusion to clarity through prayer and revelation.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>Facing difficult decisions requiring divine guidance</li>
                            <li>Feeling disconnected from your spiritual purpose</li>
                            <li>Needing strength to overcome challenges</li>
                            <li>Expressing gratitude and seeking direction</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #4ecdc4; margin-left: 20px;">
                            <li>✔ Clear divine insight or revelation</li>
                            <li>✔ Renewed spiritual connection</li>
                            <li>✔ Specific action steps aligned with your soul purpose</li>
                            <li>✔ Peace and clarity about your situation</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this prayer session?</strong></p>
                    </div>
                    <textarea name="prayer_title" placeholder="Give this prayer session a meaningful title..."></textarea>
                </div>

                <!-- Step 2: Prayer Subject -->
                <div id="prayer-step-2" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Who or what are you stacking?</strong></p>
                        <p style="color: #b8b8b8;">What/who prompted you to pray - could be a person, situation, challenge, or blessing.</p>
                    </div>
                    <textarea name="prayer_subject" placeholder="Describe who or what brought you to prayer..."></textarea>
                </div>

                <!-- Step 3: Prayer Trigger -->
                <div id="prayer-step-3" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>About "<span class="previous-answer" id="prayer-subject-preview"></span>"</p>
                        <p><strong>In this moment, why has this triggered you to pray?</strong></p>
                    </div>
                    <textarea name="prayer_trigger" placeholder="What about this situation calls you to prayer..."></textarea>
                </div>

                <!-- Step 4: Situation Story -->
                <div id="prayer-step-4" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the story you're telling yourself, created by this trigger, about the situation?</strong></p>
                    </div>
                    <textarea name="prayer_story" placeholder="Share your interpretation of the circumstances..."></textarea>
                </div>

                <!-- Step 5: Emotional Response -->
                <div id="prayer-step-5" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Describe the single word feelings that arise for you when you tell yourself that story?</strong></p>
                    </div>
                    <textarea name="prayer_feelings" placeholder="Name your emotions (grateful, worried, excited, humble, etc.)..."></textarea>
                </div>

                <!-- Step 6: Want God to Know -->
                <div id="prayer-step-6" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Complete this multiple times: "I want GOD to know..."</strong></p>
                        <p style="color: #b8b8b8;">Keep going until you've shared everything on your heart.</p>
                    </div>
                    <textarea name="prayer_want_god_know" style="min-height: 200px;" placeholder="I want GOD to know...
I want GOD to know...
I want GOD to know...
I want GOD to know..."></textarea>
                </div>

                <!-- Step 7: Prayer -->
                <div id="prayer-step-7" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Dear GOD,</strong></p>
                        <p style="color: #b8b8b8;">Speak directly to God. Express gratitude, ask for guidance, share concerns, seek strength.</p>
                    </div>
                    <textarea name="prayer_to_god" style="min-height: 250px;" placeholder="Dear GOD..."></textarea>
                </div>

                <!-- Step 8: Life Lesson -->
                <div id="prayer-step-8" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the singular lesson on life you are taking from this prayer session?</strong></p>
                    </div>
                    <textarea name="prayer_lesson" placeholder="The key insight or principle I'm learning..."></textarea>
                </div>

                <!-- Step 9: Revelation & Commitment -->
                <div id="prayer-step-9" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the most significant revelation or insight you are leaving this prayer session with, and why do you feel that way?</strong></p>
                    </div>
                    <textarea name="prayer_revelation" placeholder="My divine insight or understanding..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>What immediate actions are you committed to taking leaving this session?</strong></p>
                    </div>
                    <textarea name="prayer_commitment" placeholder="I commit to..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="previousStep('prayer')" id="prayer-prev-btn" style="display: none;">Previous</button>
                    <button type="button" class="btn-primary" onclick="nextStep('prayer')" id="prayer-next-btn">Next Step</button>
                </div>
            </div>

            <!-- GRATITUDE SESSION (8 steps) -->
            <div id="section-gratitude-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="gratitude-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Gratitude Session</h2>
                    <p>Step <span id="gratitude-step-number">1</span> of 8</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <!-- Step 1: Session Title -->
                <div id="gratitude-step-1" class="stack-step">
                    <div style="background: rgba(255, 193, 7, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #ffc107; margin-bottom: 15px;">💛 Gratitude Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Gratitude Session helps you cultivate appreciation and recognize the abundance in your life. 
                            This 8-step process transforms your perspective and energizes you through gratitude.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>Need to shift from negative to positive energy</li>
                            <li>Want to acknowledge progress and blessings</li>
                            <li>Feeling down and need a perspective shift</li>
                            <li>Want to strengthen your gratitude practice</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #ffc107; margin-left: 20px;">
                            <li>✔ Elevated mood and energy</li>
                            <li>✔ Deeper appreciation for your journey</li>
                            <li>✔ Recognition of overlooked blessings</li>
                            <li>✔ Renewed motivation and inspiration</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this gratitude session?</strong></p>
                    </div>
                    <textarea name="gratitude_title" placeholder="Give this gratitude session a meaningful title..."></textarea>
                </div>

                <!-- Step 2: Three Grateful Things -->
                <div id="gratitude-step-2" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>List three things you're grateful for right now.</strong></p>
                        <p style="color: #b8b8b8;">Be specific and really feel the appreciation.</p>
                    </div>
                    <textarea name="gratitude_three_things" placeholder="1. 
2. 
3. "></textarea>
                </div>

                <!-- Step 3: Person You're Grateful For -->
                <div id="gratitude-step-3" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Who is someone you're deeply grateful for and why?</strong></p>
                    </div>
                    <textarea name="gratitude_person" placeholder="Person and why you're grateful for them..."></textarea>
                </div>

                <!-- Step 4: Recent Win -->
                <div id="gratitude-step-4" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What's a recent win or positive experience you're grateful for?</strong></p>
                    </div>
                    <textarea name="gratitude_win" placeholder="Describe the win and why it matters..."></textarea>
                </div>

                <!-- Step 5: Challenge That Served You -->
                <div id="gratitude-step-5" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What challenge or difficulty are you grateful for because of how it's served your growth?</strong></p>
                    </div>
                    <textarea name="gratitude_challenge" placeholder="The challenge and the growth it created..."></textarea>
                </div>

                <!-- Step 6: Body Appreciation -->
                <div id="gratitude-step-6" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What about your body, health, or physical capabilities are you grateful for?</strong></p>
                    </div>
                    <textarea name="gratitude_body" placeholder="Physical blessings you appreciate..."></textarea>
                </div>

                <!-- Step 7: Opportunity Appreciation -->
                <div id="gratitude-step-7" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What opportunity in your life are you most grateful for right now?</strong></p>
                    </div>
                    <textarea name="gratitude_opportunity" placeholder="Current or upcoming opportunity you appreciate..."></textarea>
                </div>

                <!-- Step 8: Gratitude Declaration -->
                <div id="gratitude-step-8" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Complete this gratitude declaration: "I am grateful for my life because..."</strong></p>
                    </div>
                    <textarea name="gratitude_declaration" style="min-height: 200px;" placeholder="I am grateful for my life because..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>How will you carry this gratitude forward today?</strong></p>
                    </div>
                    <textarea name="gratitude_commitment" placeholder="Actions to maintain this grateful energy..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="previousStep('gratitude')" id="gratitude-prev-btn" style="display: none;">Previous</button>
                    <button type="button" class="btn-primary" onclick="nextStep('gratitude')" id="gratitude-next-btn">Next Step</button>
                </div>
            </div>

            <!-- HAPPY SESSION (8 steps) -->
            <div id="section-happy-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="happy-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Happy Session</h2>
                    <p>Step <span id="happy-step-number">1</span> of 8</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <!-- Step 1: Title -->
                <div id="happy-step-1" class="stack-step">
                    <div style="background: rgba(76, 175, 80, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #4caf50; margin-bottom: 15px;">😊 Celebration Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Celebration Session helps you celebrate wins and extract wisdom from positive experiences. This 8-step process 
                            ensures you learn from success, maintain momentum, and amplify what's working in your life.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>You've achieved a win or breakthrough</li>
                            <li>Something wonderful has happened</li>
                            <li>Want to maintain positive momentum</li>
                            <li>Need to remind yourself of your progress</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #4caf50; margin-left: 20px;">
                            <li>✔ Deep appreciation of your success</li>
                            <li>✔ Clear understanding of what created the win</li>
                            <li>✔ Lessons to replicate success</li>
                            <li>✔ Renewed energy and motivation</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this Celebration Session?</strong></p>
                    </div>
                    <textarea name="happy_title" placeholder="Name this celebration..."></textarea>
                </div>

                <!-- Step 2: Happy Trigger -->
                <div id="happy-step-2" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>Celebrating: "<span class="previous-answer" id="happy-title-preview"></span>"</p>
                        <p><strong>What happened and Who triggered you to feel happy?</strong></p>
                    </div>
                    <textarea name="happy_trigger" placeholder="Describe the positive event and person involved..."></textarea>
                </div>

                <!-- Step 3: Current Story -->
                <div id="happy-step-3" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the story you're telling yourself right now about what happened?</strong></p>
                    </div>
                    <textarea name="happy_story" placeholder="Your interpretation of the positive situation..."></textarea>
                </div>

                <!-- Step 4: Positive Feelings -->
                <div id="happy-step-4" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What are the positive feelings you're experiencing because of this story?</strong></p>
                    </div>
                    <textarea name="happy_feelings" placeholder="List emotions like happiness, excitement, appreciation, etc..."></textarea>
                </div>

                <!-- Step 5: Inspired Actions -->
                <div id="happy-step-5" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What initial desires or actions do you notice rise for you with these feelings?</strong></p>
                    </div>
                    <textarea name="happy_actions" placeholder="What you want to do as a result of feeling good..."></textarea>
                </div>

                <!-- Step 6: Life Lesson -->
                <div id="happy-step-6" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the singular simple lesson on life you're learning from this celebration?</strong></p>
                    </div>
                    <textarea name="happy_lesson" placeholder="Key insight from this positive experience..."></textarea>
                </div>

                <!-- Step 7: Evidence -->
                <div id="happy-step-7" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What evidence do you have to support this story as absolutely true?</strong></p>
                    </div>
                    <textarea name="happy_evidence" placeholder="Facts that confirm your positive interpretation..."></textarea>
                </div>

                <!-- Step 8: Final Insights -->
                <div id="happy-step-8" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What are the FINAL INSIGHTS or REVELATIONS that you're leaving this session with?</strong></p>
                    </div>
                    <textarea name="happy_insights" placeholder="Deeper understanding and takeaways..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>What immediate actions are you committed to taking?</strong></p>
                    </div>
                    <textarea name="happy_commitment" placeholder="How you'll maintain this momentum..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="previousStep('happy')" id="happy-prev-btn" style="display: none;">Previous</button>
                    <button type="button" class="btn-primary" onclick="nextStep('happy')" id="happy-next-btn">Next Step</button>
                </div>
            </div>

            <!-- ANGRY SESSION (8 steps) -->
            <div id="section-angry-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="angry-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Angry Session</h2>
                    <p>Step <span id="angry-step-number">1</span> of 8</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <!-- Step 1: Title -->
                <div id="angry-step-1" class="stack-step">
                    <div style="background: rgba(244, 67, 54, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #f44336; margin-bottom: 15px;">😤 Anger Processing Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Anger Processing session transforms rage and irritation into strategic action. This 8-step process helps you 
                            process negative emotions, separate facts from feelings, and create empowering narratives that serve your goals.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>Someone or something has triggered your anger</li>
                            <li>Feeling frustrated and need clarity</li>
                            <li>Want to convert destructive emotions into productive action</li>
                            <li>Need to reframe a situation strategically</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #f44336; margin-left: 20px;">
                            <li>✔ Release of emotional charge</li>
                            <li>✔ Clear distinction between facts and feelings</li>
                            <li>✔ New empowering story that serves you</li>
                            <li>✔ Strategic action plan from a place of power</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this processing session?</strong></p>
                    </div>
                    <textarea name="angry_title" placeholder="Name this processing session..."></textarea>
                </div>

                <!-- Step 2: Trigger Person -->
                <div id="angry-step-2" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>Processing: "<span class="previous-answer" id="angry-title-preview"></span>"</p>
                        <p><strong>Who has triggered you to feel angry?</strong></p>
                    </div>
                    <textarea name="angry_person" placeholder="Name of person who triggered you..."></textarea>
                </div>

                <!-- Step 3: Current Story -->
                <div id="angry-step-3" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>About "<span class="previous-answer" id="angry-person-preview"></span>"</p>
                        <p><strong>What is the story you're telling yourself right now about what happened?</strong></p>
                    </div>
                    <textarea name="angry_story" placeholder="Your current interpretation of the situation..."></textarea>
                </div>

                <!-- Step 4: Negative Feelings -->
                <div id="angry-step-4" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What are the negative feelings that you're experiencing because of this story?</strong></p>
                    </div>
                    <textarea name="angry_feelings" placeholder="List your current emotions - anger, frustration, etc..."></textarea>
                </div>

                <!-- Step 5: Facts -->
                <div id="angry-step-5" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What are the FACTS (without FEELINGS) about the situation?</strong></p>
                        <p style="color: #b8b8b8;">Objective description of what actually happened.</p>
                    </div>
                    <textarea name="angry_facts" placeholder="Just the facts, no interpretation..."></textarea>
                </div>

                <!-- Step 6: True Desire -->
                <div id="angry-step-6" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Beyond the trigger of this situation, what do you truly want for YOU?</strong></p>
                    </div>
                    <textarea name="angry_desire" placeholder="What you actually want to achieve or experience..."></textarea>
                </div>

                <!-- Step 7: Strategic Story -->
                <div id="angry-step-7" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is a more strategic story that you could create to assure you get what you truly want?</strong></p>
                    </div>
                    <textarea name="angry_new_story" placeholder="A new interpretation that serves your goals..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>How does this new strategic story make you feel?</strong></p>
                    </div>
                    <textarea name="angry_new_feelings" placeholder="Emotional response to your new perspective..."></textarea>
                </div>

                <!-- Step 8: Insight & Action -->
                <div id="angry-step-8" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the singular, simple lesson on life you're learning from this anger processing?</strong></p>
                    </div>
                    <textarea name="angry_lesson" placeholder="Core lesson for life application..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>What action do you feel called to take?</strong></p>
                    </div>
                    <textarea name="angry_action" placeholder="Specific action you'll take as a result..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="previousStep('angry')" id="angry-prev-btn" style="display: none;">Previous</button>
                    <button type="button" class="btn-primary" onclick="nextStep('angry')" id="angry-next-btn">Next Step</button>
                </div>
            </div>

            <!-- WAR/ACTION SESSION (7 steps) -->
            <div id="section-war-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="war-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>War/Action Session</h2>
                    <p>Step <span id="war-step-number">1</span> of 7</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <!-- Step 1: Title -->
                <div id="war-step-1" class="stack-step">
                    <div style="background: rgba(255, 107, 107, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #ff6b6b; margin-bottom: 15px;">⚔️ WAR/Action Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The WAR Session transforms productive ideas into actionable battle plans. This 7-step process helps you 
                            evaluate opportunities, identify obstacles, and create measurable facts (action steps) to execute your vision.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>You have a new business or life idea to develop</li>
                            <li>Need to turn inspiration into concrete action</li>
                            <li>Want to evaluate if an opportunity is worth pursuing</li>
                            <li>Ready to overcome obstacles and execute</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #ff6b6b; margin-left: 20px;">
                            <li>✔ Clear evaluation of your idea's potential</li>
                            <li>✔ Three specific, measurable action steps (FACTS)</li>
                            <li>✔ Identified obstacles with solutions</li>
                            <li>✔ Commitment to immediate execution</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this WAR/Action Session?</strong></p>
                    </div>
                    <textarea name="war_title" placeholder="Give your idea a powerful title..."></textarea>
                </div>

                <!-- Step 2: Source -->
                <div id="war-step-2" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>Your idea: "<span class="previous-answer" id="war-title-preview"></span>"</p>
                        <p><strong>Who/What are you stacking?</strong></p>
                        <p style="color: #b8b8b8;">Person, situation, or source that sparked the idea.</p>
                    </div>
                    <textarea name="war_source" placeholder="What or who triggered this idea..."></textarea>
                </div>

                <!-- Step 3: Idea Description -->
                <div id="war-step-3" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>Based on "<span class="previous-answer" id="war-source-preview"></span>"</p>
                        <p><strong>In this moment, what Idea has this activated in you?</strong></p>
                    </div>
                    <textarea name="war_idea" placeholder="Describe the specific idea or opportunity..."></textarea>
                </div>

                <!-- Step 4: Story -->
                <div id="war-step-4" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the story you're telling yourself about this new idea?</strong></p>
                    </div>
                    <textarea name="war_story" placeholder="Your interpretation and vision for this idea..."></textarea>
                </div>

                <!-- Step 5: Feelings -->
                <div id="war-step-5" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>Describe the single word feelings that arise for you when you tell yourself that story?</strong></p>
                    </div>
                    <textarea name="war_feelings" placeholder="Primary emotions (excited, curious, motivated, etc.)..."></textarea>
                </div>

                <!-- Step 6: Benefits -->
                <div id="war-step-6" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>If this productive idea is executed on, what are the positive benefits to your world and those you are connected to?</strong></p>
                    </div>
                    <textarea name="war_benefits" placeholder="How success would impact you and others..."></textarea>
                </div>

                <!-- Step 7: Action Plan -->
                <div id="war-step-7" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What are your first THREE measurable FACTS (action steps)?</strong></p>
                        <p style="color: #b8b8b8;">List specific, actionable steps with potential obstacles and solutions.</p>
                    </div>
                    <textarea name="war_facts" style="min-height: 250px;" placeholder="FACT 1: [Specific action]
Why it's important: 
Potential obstacles: 
How to overcome: 

FACT 2: [Specific action]
Why it's important: 
Potential obstacles: 
How to overcome: 

FACT 3: [Specific action]
Why it's important: 
Potential obstacles: 
How to overcome: "></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>What immediate actions are you committed to taking?</strong></p>
                    </div>
                    <textarea name="war_commitment" placeholder="Your immediate next steps..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="previousStep('war')" id="war-prev-btn" style="display: none;">Previous</button>
                    <button type="button" class="btn-primary" onclick="nextStep('war')" id="war-next-btn">Next Step</button>
                </div>
            </div>

            <!-- DISCOVER SESSION (5 steps) -->
            <div id="section-discover-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="discover-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Discover Session</h2>
                    <p>Step <span id="discover-step-number">1</span> of 5</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <!-- Step 1: Title -->
                <div id="discover-step-1" class="stack-step">
                    <div style="background: rgba(156, 39, 176, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #9c27b0; margin-bottom: 15px;">🔍 Discovery Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Discovery Session extracts wisdom from learning experiences and turns insights into practical application. 
                            This 5-step process helps you capture revelations from books, training, conversations, or personal experiences.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>You've learned something significant from a book or course</li>
                            <li>Had an important realization or "aha" moment</li>
                            <li>Want to apply new knowledge to your life</li>
                            <li>Need to process and integrate learning</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #9c27b0; margin-left: 20px;">
                            <li>✔ Clear articulation of your discovery</li>
                            <li>✔ Understanding of why it matters to you</li>
                            <li>✔ Practical application to your life</li>
                            <li>✔ Immediate action steps to implement</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this Discovery Session?</strong></p>
                    </div>
                    <textarea name="discover_title" placeholder="Name this discovery session..."></textarea>
                </div>

                <!-- Step 2: Source -->
                <div id="discover-step-2" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>Discovery: "<span class="previous-answer" id="discover-title-preview"></span>"</p>
                        <p><strong>What resource(s) were you studying today?</strong></p>
                        <p style="color: #b8b8b8;">Book, course, person, experience, or situation that provided the insight.</p>
                    </div>
                    <textarea name="discover_source" placeholder="Book, course, person, experience..."></textarea>
                </div>

                <!-- Step 3: Discovery Content -->
                <div id="discover-step-3" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p>From "<span class="previous-answer" id="discover-source-preview"></span>"</p>
                        <p><strong>What did you discover during your study session?</strong></p>
                        <p style="color: #b8b8b8;">The specific insight, principle, or revelation you gained.</p>
                    </div>
                    <textarea name="discover_content" placeholder="The specific insight or revelation..."></textarea>
                </div>

                <!-- Step 4: Story & Significance -->
                <div id="discover-step-4" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the story you're telling yourself about this discovery?</strong></p>
                    </div>
                    <textarea name="discover_story" placeholder="How you interpret and relate to this discovery..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>Why do you feel this specific discovery was significant?</strong></p>
                    </div>
                    <textarea name="discover_significance" placeholder="Why this insight matters to you..."></textarea>
                </div>

                <!-- Step 5: Application -->
                <div id="discover-step-5" class="stack-step section-hidden">
                    <div class="question-prompt">
                        <p><strong>What is the singular, simple lesson on life you're learning from this Discovery Session?</strong></p>
                    </div>
                    <textarea name="discover_lesson" placeholder="The essential principle or truth you've learned..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 20px;">
                        <p><strong>What immediate actions are you committed to taking leaving this session?</strong></p>
                    </div>
                    <textarea name="discover_commitment" placeholder="Specific steps you'll take to implement this discovery..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="previousStep('discover')" id="discover-prev-btn" style="display: none;">Previous</button>
                    <button type="button" class="btn-primary" onclick="nextStep('discover')" id="discover-next-btn">Next Step</button>
                </div>
            </div>

            <!-- OPEN SESSION -->
            <div id="section-open-stack" class="form-section section-hidden">
                <div class="step-indicator">
                    <h2>Open Session</h2>
                    <p>Freestyle Format</p>
                    <button type="button" class="btn-secondary" onclick="backToSelection()" style="margin-top: 10px;">
                        ← Change Session Type
                    </button>
                </div>

                <div class="stack-step">
                    <div style="background: rgba(33, 150, 243, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #2196f3; margin-bottom: 15px;">🌟 Open Format Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Open Format is your freestyle session for custom processing. This flexible approach lets you create 
                            your own structure for reflection, analysis, or any situation that doesn't fit the other session types.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>Need a "Working/Not Working" analysis</li>
                            <li>Want to do weekly or monthly reflection</li>
                            <li>Creating custom gratitude or growth sessions</li>
                            <li>Exploring something unique to your situation</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Popular Formats:</strong></p>
                        <ul style="color: #2196f3; margin-left: 20px;">
                            <li>✔ Working/Not Working Analysis</li>
                            <li>✔ Start/Stop/Continue Framework</li>
                            <li>✔ Weekly Wins & Lessons</li>
                            <li>✔ Gratitude and Growth Reflection</li>
                            <li>✔ Core 4 Domain Review</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this Open Session?</strong></p>
                    </div>
                    <textarea name="open_title" placeholder="Name your freestyle session..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 30px;">
                        <p><strong>Time to freestyle your own session. 3-2-1 off you go...</strong></p>
                        <p style="color: #b8b8b8; margin-top: 10px;">Choose from the templates below or create your own structure:</p>
                    </div>
                    <textarea name="open_content" style="min-height: 400px;" placeholder="TEMPLATE 1: Working/Not Working
=====================================
WORKING:
- 
- 
- 

NOT WORKING:
- 
- 
- 

ACTIONS TO AMPLIFY WHAT'S WORKING:
- 
- 

ACTIONS TO FIX WHAT'S NOT:
- 
- 


TEMPLATE 2: Weekly Reflection
=====================================
THIS WEEK'S WINS:
- 
- 

KEY LESSONS LEARNED:
- 
- 

NEXT WEEK'S FOCUS:
- 
- 


Or create your own structure..."></textarea>
                </div>
                
                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="backToSelection()">Back to Selection</button>
                    <button type="button" class="btn-primary" onclick="completeOpenStack()">Complete Session</button>
                </div>
            </div>

            <!-- Completion Section -->
            <div id="section-completion" class="form-section section-hidden">
                <div class="completion-message">
                    <h2>🎉 Session Complete!</h2>
                    <p>Your session has been recorded and sent to processing.</p>
                    <p>Thank you for taking the time to process and grow.</p>
                    
                    <div class="button-group" style="justify-content: center;">
                        <button type="button" class="btn-primary" onclick="startNewSession()">Start New Session</button>
                        <button type="button" class="btn-secondary" onclick="goBackToDashboard()">Return to Dashboard</button>
                    </div>
                </div>
            </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Transformation Sessions</h4>
                <p>Structured processing frameworks to transform thoughts into action and extract wisdom from every experience.</p>
            </div>
            <div class="footer-section">
                <h4>Quick Navigation</h4>
                <ul class="footer-links">
                    <li><a href="https://dvries10271.github.io/Coaching_Command_Center/">Main Dashboard</a></li>
                    <li><a href="https://dvries10271.github.io/Analytics-Dashboard/">Analytics Dashboard</a></li>
                    <li><a href="https://dvries10271.github.io/Action-Command-Center/">Action Center</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Session Types</h4>
                <ul class="footer-links">
                    <li><a href="#" onclick="selectStackType('prayer'); return false;">Prayer Session</a></li>
                    <li><a href="#" onclick="selectStackType('gratitude'); return false;">Gratitude Session</a></li>
                    <li><a href="#" onclick="selectStackType('happy'); return false;">Happy Session</a></li>
                    <li><a href="#" onclick="selectStackType('angry'); return false;">Anger Processing</a></li>
                    <li><a href="#" onclick="selectStackType('war'); return false;">War/Action Session</a></li>
                    <li><a href="#" onclick="selectStackType('discover'); return false;">Discovery Session</a></li>
                    <li><a href="#" onclick="selectStackType('open'); return false;">Open Format</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>System Status</h4>
                <div class="status-info" style="display: flex; align-items: center; gap: 0.5rem; color: rgba(255, 255, 255, 0.8); font-size: 0.9rem; margin-bottom: 0.5rem;">
                    <span class="status-dot" style="width: 8px; height: 8px; border-radius: 50%; background: #4caf50; animation: pulse 2s infinite;"></span>
                    <span>Session Module Active</span>
                </div>
                <div style="color: rgba(255, 255, 255, 0.5); font-size: 0.85rem;">
                    Auto-save: Enabled
                </div>
                <div style="color: rgba(255, 255, 255, 0.5); font-size: 0.85rem;" id="footerLastSave">
                    Last saved: Never
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2025 Lead Generation Experts LLC Coaching System. Built With Purpose. All Rights Reserved.</p>
            <p style="margin-top: 0.5rem; font-size: 0.8rem; color: rgba(255, 255, 255, 0.3);">Transformation Sessions v2.0 | Enhanced September 2025</p>
        </div>
    </footer>

    <script>
        // Configuration
        const stackConfigs = {
            prayer: { steps: 9, section: 'prayer-stack' },
            gratitude: { steps: 8, section: 'gratitude-stack' },
            happy: { steps: 8, section: 'happy-stack' },
            angry: { steps: 8, section: 'angry-stack' },
            war: { steps: 7, section: 'war-stack' },
            discover: { steps: 5, section: 'discover-stack' },
            open: { steps: 1, section: 'open-stack' }
        };

        let currentStack = null;
        let currentStep = {};

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Page loaded - initializing...');
            
            // Check for logged-in user
            checkUserAuthentication();
            
            // Initialize step trackers
            Object.keys(stackConfigs).forEach(stack => {
                currentStep[stack] = 1;
            });

            // Load saved data
            loadSavedData();

            // Stack card selection
            document.querySelectorAll('.stack-card').forEach(card => {
                card.addEventListener('click', () => {
                    document.querySelectorAll('.stack-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    currentStack = card.dataset.stack;
                    document.getElementById('selected-stack').value = currentStack;
                    document.getElementById('start-stack-btn').disabled = false;
                    console.log(`Selected stack: ${currentStack}`);
                });
            });

            // Start button
            document.getElementById('start-stack-btn').addEventListener('click', () => {
                if (!validateRequiredFields()) {
                    return;
                }
                
                if (currentStack) {
                    console.log(`Starting ${currentStack} stack`);
                    document.getElementById('section-stack-selection').classList.add('section-hidden');
                    
                    const sectionId = `section-${stackConfigs[currentStack].section}`;
                    const section = document.getElementById(sectionId);
                    if (section) {
                        section.classList.remove('section-hidden');
                        currentStep[currentStack] = 1;
                        updateProgress(currentStack);
                        console.log(`Showing section: ${sectionId}`);
                    } else {
                        console.log(`ERROR: Section not found: ${sectionId}`);
                    }
                }
            });

            // Auto-save all textareas
            document.querySelectorAll('textarea').forEach(textarea => {
                textarea.addEventListener('input', () => {
                    localStorage.setItem(`stack_${textarea.name}`, textarea.value);
                    updatePreviews();
                    showSaveIndicator();
                    console.log(`Saved: ${textarea.name}`);
                });
            });

            // Auto-save all input fields
            document.querySelectorAll('input, select').forEach(input => {
                const savedValue = localStorage.getItem(`stack_${input.name}`);
                if (savedValue) {
                    input.value = savedValue;
                }
                
                input.addEventListener('change', () => {
                    localStorage.setItem(`stack_${input.name}`, input.value);
                    showSaveIndicator();
                });
            });

            console.log('Initialization complete');
        });

        function checkUserAuthentication() {
            const userEmail = localStorage.getItem('coaching_user_email');
            const userData = localStorage.getItem('coaching_user_data');
            
            if (userEmail && userData) {
                try {
                    const user = JSON.parse(userData);
                    console.log('User authenticated: ' + user.name);
                    
                    document.getElementById('manual-entry-form').style.display = 'none';
                    document.getElementById('logged-in-display').style.display = 'block';
                    document.getElementById('display-name').textContent = user.name || 'User';
                    document.getElementById('display-email').textContent = user.email || userEmail;
                    document.getElementById('user-name').value = user.name || 'User';
                    document.getElementById('user-email').value = user.email || userEmail;
                    document.getElementById('user-name').removeAttribute('required');
                    document.getElementById('user-email').removeAttribute('required');
                    document.getElementById('user-name').classList.remove('required-field');
                    document.getElementById('user-email').classList.remove('required-field');
                } catch (error) {
                    console.log('Error parsing user data: ' + error);
                    showManualEntry();
                }
            } else {
                console.log('No user authentication found');
                showManualEntry();
            }
        }

        function showManualEntry() {
            document.getElementById('manual-entry-form').style.display = 'block';
            document.getElementById('logged-in-display').style.display = 'none';
        }

        function showSaveIndicator() {
            const indicator = document.getElementById('saveIndicator');
            indicator.classList.add('show');
            
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            const footerSave = document.getElementById('footerLastSave');
            if (footerSave) {
                footerSave.textContent = 'Last saved: ' + timeString;
            }
            
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }

        function loadSavedData() {
            console.log('Loading saved data from localStorage');
            let loadedCount = 0;
            document.querySelectorAll('textarea').forEach(textarea => {
                const savedValue = localStorage.getItem(`stack_${textarea.name}`);
                if (savedValue) {
                    textarea.value = savedValue;
                    loadedCount++;
                }
            });
            console.log(`Loaded ${loadedCount} saved fields`);
        }

        function updatePreviews() {
            document.querySelectorAll('.previous-answer').forEach(span => {
                const id = span.id;
                if (!id) return;
                
                const fieldName = id.replace('-preview', '').replace(/-/g, '_');
                const sourceTextarea = document.querySelector(`textarea[name="${fieldName}"]`);
                
                if (sourceTextarea && sourceTextarea.value) {
                    const preview = sourceTextarea.value.substring(0, 100);
                    span.textContent = preview + (sourceTextarea.value.length > 100 ? '...' : '');
                }
            });
        }

        function updateProgress(stackType) {
            const progress = (currentStep[stackType] / stackConfigs[stackType].steps) * 100;
            const progressBar = document.getElementById(`${stackType}-progress`);
            if (progressBar) {
                progressBar.style.width = `${progress}%`;
                console.log(`Progress for ${stackType}: ${progress.toFixed(1)}%`);
            }
        }

        function updateStepNumber(stackType) {
            const stepNumber = document.getElementById(`${stackType}-step-number`);
            if (stepNumber) {
                stepNumber.textContent = currentStep[stackType];
            }
        }

        function nextStep(stackType) {
            console.log(`Next step for ${stackType}: ${currentStep[stackType]} -> ${currentStep[stackType] + 1}`);
            const maxSteps = stackConfigs[stackType].steps;
            
            if (currentStep[stackType] < maxSteps) {
                // Hide current step
                const currentStepElement = document.getElementById(`${stackType}-step-${currentStep[stackType]}`);
                if (currentStepElement) {
                    currentStepElement.classList.add('section-hidden');
                }
                
                // Move to next step
                currentStep[stackType]++;
                
                // Show next step
                const nextStepElement = document.getElementById(`${stackType}-step-${currentStep[stackType]}`);
                if (nextStepElement) {
                    nextStepElement.classList.remove('section-hidden');
                }
                
                // Show Previous button after step 1
                const prevBtn = document.getElementById(`${stackType}-prev-btn`);
                if (prevBtn && currentStep[stackType] > 1) {
                    prevBtn.style.display = 'block';
                }
                
                updateProgress(stackType);
                updateStepNumber(stackType);
                updatePreviews();
                
                // Update button for last step
                if (currentStep[stackType] === maxSteps) {
                    const nextBtn = document.getElementById(`${stackType}-next-btn`);
                    if (nextBtn) {
                        nextBtn.textContent = 'Complete Session';
                        nextBtn.onclick = () => completeStack(stackType);
                    }
                }
            }
        }

        function previousStep(stackType) {
            console.log(`Previous step for ${stackType}: ${currentStep[stackType]} -> ${currentStep[stackType] - 1}`);
            
            if (currentStep[stackType] > 1) {
                // Hide current step
                const currentStepElement = document.getElementById(`${stackType}-step-${currentStep[stackType]}`);
                if (currentStepElement) {
                    currentStepElement.classList.add('section-hidden');
                }
                
                // Move to previous step
                currentStep[stackType]--;
                
                // Show previous step
                const prevStepElement = document.getElementById(`${stackType}-step-${currentStep[stackType]}`);
                if (prevStepElement) {
                    prevStepElement.classList.remove('section-hidden');
                }
                
                // Hide Previous button if back at step 1
                const prevBtn = document.getElementById(`${stackType}-prev-btn`);
                if (prevBtn && currentStep[stackType] === 1) {
                    prevBtn.style.display = 'none';
                }
                
                updateProgress(stackType);
                updateStepNumber(stackType);
                
                // Reset button text
                const nextBtn = document.getElementById(`${stackType}-next-btn`);
                if (nextBtn && currentStep[stackType] < stackConfigs[stackType].steps) {
                    nextBtn.textContent = 'Next Step';
                    nextBtn.onclick = () => nextStep(stackType);
                }
            }
        }

        function completeStack(stackType) {
            console.log(`Completing ${stackType} session`);
            
            // Collect all data
            const formData = new FormData(document.getElementById('stack-form'));
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            console.log('Form data collected:', Object.keys(data));
            
            // WEBHOOK SUBMISSION
            submitToWebhook(data);
            
            // Show completion
            document.getElementById(`section-${stackConfigs[stackType].section}`).classList.add('section-hidden');
            document.getElementById('section-completion').classList.remove('section-hidden');
            
            // Clear localStorage for this stack
            clearStackData(stackType);
        }

        function completeOpenStack() {
            completeStack('open');
        }

        function submitToWebhook(data) {
            // CRITICAL: This is your webhook URL
            const webhookUrl = 'https://n8n-production-3280.up.railway.app/webhook/stack-form-submit';
            console.log(`WEBHOOK: Submitting to ${webhookUrl}`);
            
            // Add metadata
            const payload = {
                ...data,
                timestamp: new Date().toISOString(),
                user_id: localStorage.getItem('coaching_user_email') || 'web_form_user',
                session_type: currentStack
            };
            
            console.log('WEBHOOK: Sending payload with session_type:', payload.session_type);
            
            fetch(webhookUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(payload)
            })
            .then(response => {
                console.log('WEBHOOK: Response status:', response.status);
                if (response.ok) {
                    console.log('WEBHOOK: Session submitted successfully');
                } else {
                    console.error('WEBHOOK: Error response:', response.status);
                }
                return response.text();
            })
            .then(text => {
                console.log('WEBHOOK: Response text:', text);
            })
            .catch(error => {
                console.error('WEBHOOK ERROR: Failed to submit session:', error);
            });
        }

        function clearStackData(stackType) {
            console.log(`Clearing saved data for ${stackType}`);
            document.querySelectorAll(`textarea[name^="${stackType}_"]`).forEach(textarea => {
                localStorage.removeItem(`stack_${textarea.name}`);
            });
        }

        function validateRequiredFields() {
            const userEmail = localStorage.getItem('coaching_user_email');
            const userData = localStorage.getItem('coaching_user_data');
            
            if (userEmail && userData) {
                console.log('User authenticated - skipping name/email validation');
                return true;
            }
            
            const requiredFields = document.querySelectorAll('.required-field');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    isValid = false;
                    field.style.borderColor = '#ff4336';
                }
            });
            
            if (!isValid) {
                const errorMsg = document.getElementById('error-message');
                if (errorMsg) {
                    errorMsg.style.display = 'block';
                }
                console.log('Validation failed');
            }
            
            return isValid;
        }

        function goBackToDashboard() {
            window.location.href = 'https://dvries10271.github.io/Coaching_Command_Center/';
        }

        function backToSelection() {
            console.log('Returning to session selection');
            document.querySelectorAll('.form-section').forEach(section => {
                section.classList.add('section-hidden');
            });
            document.getElementById('section-stack-selection').classList.remove('section-hidden');
        }

        function selectStackType(stackType) {
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            document.querySelectorAll('.stack-card').forEach(c => c.classList.remove('selected'));
            
            const targetCard = document.querySelector(`[data-stack="${stackType}"]`);
            if (targetCard) {
                targetCard.classList.add('selected');
                currentStack = stackType;
                document.getElementById('selected-stack').value = stackType;
                document.getElementById('start-stack-btn').disabled = false;
                console.log(`Selected stack via footer: ${stackType}`);
            }
        }

        function startNewSession() {
            console.log('Starting new session');
            
            // Reset everything
            currentStack = null;
            Object.keys(stackConfigs).forEach(stack => {
                currentStep[stack] = 1;
            });
            document.getElementById('selected-stack').value = '';
            document.getElementById('start-stack-btn').disabled = true;
            document.querySelectorAll('.stack-card').forEach(c => c.classList.remove('selected'));
            
            // Clear textareas
            document.querySelectorAll('textarea').forEach(t => {
                t.value = '';
                localStorage.removeItem(`stack_${t.name}`);
            });
            
            // Reset all steps
            document.querySelectorAll('.stack-step').forEach((step, index) => {
                if (step.id.endsWith('-step-1')) {
                    step.classList.remove('section-hidden');
                } else {
                    step.classList.add('section-hidden');
                }
            });
            
            // Reset progress bars
            document.querySelectorAll('.progress-fill').forEach(bar => {
                bar.style.width = '0%';
            });
            
            // Show selection screen
            document.getElementById('section-completion').classList.add('section-hidden');
            document.getElementById('section-stack-selection').classList.remove('section-hidden');
        }
    </script>
</body>
</html>
