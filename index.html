<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transformation Sessions - Coaching Command Center</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            min-height: 100vh;
            color: #ffffff;
            display: flex;
            flex-direction: column;
        }

        /* Back Button */
        .back-button {
            position: fixed;
            top: 30px;
            left: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        .back-arrow {
            font-size: 18px;
        }

        /* Header */
        .dashboard-header {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 80px;
            padding-bottom: 20px;
        }

        .dashboard-title {
            font-size: 48px;
            font-weight: bold;
            background: linear-gradient(135deg, #4ecdc4 0%, #44a8b3 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .dashboard-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 18px;
            font-style: italic;
        }

        /* Main Container */
        .main-content {
            flex: 1;
            padding: 0 20px 40px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 40px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-hidden {
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ecdc4, #44a8b3);
            border-radius: 3px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .step-indicator {
            text-align: center;
            margin-bottom: 30px;
        }

        .step-indicator h2 {
            margin-bottom: 5px;
        }

        .step-indicator p {
            color: #b8b8b8;
        }

        .stack-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stack-card {
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .stack-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
            border-color: #4ecdc4;
        }

        .stack-card.selected {
            background: rgba(78, 205, 196, 0.2);
            border-color: #4ecdc4;
            transform: scale(1.05);
        }

        .stack-card h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            color: #ffffff;
        }

        .stack-card .icon {
            font-size: 1.5em;
        }

        .stack-card .description {
            color: #b8b8b8;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .stack-card .steps {
            color: #4ecdc4;
            font-weight: bold;
            font-size: 0.85em;
        }

        .stack-step {
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .question-prompt {
            margin-bottom: 20px;
        }

        .question-prompt p {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .previous-answer {
            color: #4ecdc4;
            font-style: italic;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #ffffff;
            font-size: 1em;
            resize: vertical;
            transition: all 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: #4ecdc4;
            background: rgba(255, 255, 255, 0.08);
        }

        textarea::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 30px;
            justify-content: space-between;
        }

        button {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4ecdc4, #44a8b3);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(78, 205, 196, 0.3);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .completion-message {
            text-align: center;
            padding: 40px;
        }

        .completion-message h2 {
            color: #4ecdc4;
            margin-bottom: 20px;
        }

        .completion-message p {
            color: #b8b8b8;
            margin-bottom: 30px;
        }

        .save-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: rgba(78, 205, 196, 0.9);
            color: white;
            border-radius: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .save-indicator.show {
            opacity: 1;
        }

        /* Footer */
        .footer {
            background: linear-gradient(135deg, #1a1a2e 0%, #0a0a0f 100%);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: auto;
            padding: 3rem 2rem 2rem;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-section h4 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .footer-section p {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.5rem;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.6);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: #667eea;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.85rem;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .back-button {
                top: 15px;
                left: 15px;
                padding: 10px 20px;
                font-size: 14px;
            }

            .dashboard-title {
                font-size: 36px;
            }

            .dashboard-header {
                padding-top: 70px;
            }

            .form-section {
                padding: 25px;
            }

            .stack-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Back to Dashboard Button -->
    <button class="back-button" onclick="goBackToDashboard()">
        <span class="back-arrow">←</span>
        <span>Back to Dashboard</span>
    </button>

    <!-- Save Indicator -->
    <div class="save-indicator" id="saveIndicator">Auto-saved</div>

    <!-- Header -->
    <div class="dashboard-header">
        <h1 class="dashboard-title">Transformation Sessions</h1>
        <p class="dashboard-subtitle">Transform your thoughts into action through structured processing</p>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <form id="stack-form">
            
            <!-- Section 1: Session Type Selection -->
            <div id="section-stack-selection" class="form-section">
                <!-- User Information Section -->
                <div id="user-info-section" style="margin-bottom: 40px; padding: 25px; background: rgba(255, 255, 255, 0.03); border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <h3 style="margin-bottom: 20px; color: #4ecdc4;">Session Information</h3>
                    
                    <!-- Logged-in User Display -->
                    <div id="logged-in-display" style="display: none; margin-bottom: 20px;">
                        <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: rgba(78, 205, 196, 0.1); border-radius: 10px;">
                            <div style="font-size: 2em;">👤</div>
                            <div>
                                <div style="font-weight: 600; color: #ffffff; font-size: 1.1em;" id="display-name">User Name</div>
                                <div style="color: #b8b8b8; font-size: 0.9em;" id="display-email">user@email.com</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Manual Entry Form -->
                    <div id="manual-entry-form">
                        <div id="error-message" style="display: none; background: rgba(255, 67, 54, 0.2); border: 1px solid #ff4336; 
                                                        color: #ff8a80; padding: 12px; border-radius: 8px; margin-bottom: 20px;">
                            <strong>Please fill in all required fields</strong>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: #b8b8b8; font-size: 0.9em;">
                                    Name <span style="color: #ff4336;">*</span>
                                </label>
                                <input type="text" id="user-name" name="user_name" required
                                       class="required-field"
                                       style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.05); 
                                              border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; 
                                              color: white;" placeholder="Your name (required)">
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: #b8b8b8; font-size: 0.9em;">
                                    Email <span style="color: #ff4336;">*</span>
                                </label>
                                <input type="email" id="user-email" name="user_email" required
                                       class="required-field"
                                       style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.05); 
                                              border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; 
                                              color: white;" placeholder="your@email.com (required)">
                            </div>
                        </div>
                        
                        <p style="margin-top: 15px; color: #b8b8b8; font-size: 0.85em;">
                            <span style="color: #ff4336;">*</span> Required fields
                        </p>
                    </div>
                    
                    <!-- Energy Level (always visible) -->
                    <div style="margin-top: 20px;">
                        <label style="display: block; margin-bottom: 5px; color: #b8b8b8; font-size: 0.9em;">
                            Current Energy Level (1-10) <span style="color: #4ecdc4;">Optional</span>
                        </label>
                        <input type="number" id="energy-level" name="energy_level" min="1" max="10" 
                               style="width: 100%; max-width: 300px; padding: 10px; background: rgba(255, 255, 255, 0.05); 
                                      border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; 
                                      color: white;" placeholder="How's your energy? (1-10)">
                    </div>
                </div>

                <h2>Choose Your Session Type</h2>
                <p style="margin-bottom: 30px; color: #b8b8b8;">Select the session that best matches your current need:</p>
                
                <div class="stack-grid">
                    <div class="stack-card" data-stack="prayer">
                        <h3><span class="icon">🙏</span> Prayer Session</h3>
                        <div class="description">Connect with divine guidance and spiritual wisdom.</div>
                        <div class="steps">9 transformative steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="gratitude">
                        <h3><span class="icon">💛</span> Gratitude Session</h3>
                        <div class="description">Lift your spirit and appreciate your progression.</div>
                        <div class="steps">8 appreciation steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="happy">
                        <h3><span class="icon">😊</span> Happy Session</h3>
                        <div class="description">Celebrate wins and extract positive lessons.</div>
                        <div class="steps">8 celebration steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="angry">
                        <h3><span class="icon">😤</span> Angry Session</h3>
                        <div class="description">Transform anger into strategic action.</div>
                        <div class="steps">8 processing steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="war">
                        <h3><span class="icon">⚔️</span> War/Action Session</h3>
                        <div class="description">Transform ideas into actionable plans.</div>
                        <div class="steps">7 strategic steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="discover">
                        <h3><span class="icon">🔍</span> Discover Session</h3>
                        <div class="description">Extract wisdom from learning experiences.</div>
                        <div class="steps">5 exploratory steps</div>
                    </div>
                    
                    <div class="stack-card" data-stack="open">
                        <h3><span class="icon">🌟</span> Open Session</h3>
                        <div class="description">Freestyle format for custom processing.</div>
                        <div class="steps">Flexible format</div>
                    </div>
                </div>
                
                <input type="hidden" id="selected-stack" name="stack_type" value="">
                
                <div class="button-group">
                    <button type="button" class="btn-primary" id="start-stack-btn" disabled>
                        Begin Session
                    </button>
                </div>
            </div>

            <!-- PRAYER SESSION -->
            <div id="section-prayer-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="prayer-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Prayer Session</h2>
                    <p>Step <span id="prayer-step-number">1</span> of 9</p>
                </div>

                <div id="prayer-step-1" class="stack-step">
                    <div style="background: rgba(78, 205, 196, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #4ecdc4; margin-bottom: 15px;">🙏 Prayer Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Prayer Session is designed to deepen your spiritual connection and align your actions with divine purpose. 
                            This 9-step process helps you move from confusion to clarity through prayer and revelation.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>Facing difficult decisions requiring divine guidance</li>
                            <li>Feeling disconnected from your spiritual purpose</li>
                            <li>Needing strength to overcome challenges</li>
                            <li>Expressing gratitude and seeking direction</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #4ecdc4; margin-left: 20px;">
                            <li>✓ Clear divine insight or revelation</li>
                            <li>✓ Renewed spiritual connection</li>
                            <li>✓ Specific action steps aligned with your soul purpose</li>
                            <li>✓ Peace and clarity about your situation</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this prayer session?</strong></p>
                    </div>
                    <textarea name="prayer_title" placeholder="Give this prayer session a meaningful title..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="backToSelection()">Back to Selection</button>
                    <button type="button" class="btn-primary" onclick="completeSession('prayer')">Complete Session</button>
                </div>
            </div>

            <!-- GRATITUDE SESSION -->
            <div id="section-gratitude-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="gratitude-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Gratitude Session</h2>
                    <p>Step <span id="gratitude-step-number">1</span> of 8</p>
                </div>

                <div id="gratitude-step-1" class="stack-step">
                    <div style="background: rgba(255, 215, 0, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #ffd700; margin-bottom: 15px;">💛 Gratitude Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Gratitude Session lifts your spirit, allows you to see your progression, and improves relationships 
                            across all Core 4 areas. It helps you appreciate what you have and transforms challenges into growth opportunities.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>You want to acknowledge progress and wins</li>
                            <li>Someone has positively impacted your life</li>
                            <li>You need to shift perspective on challenges</li>
                            <li>Celebrating milestones or achievements</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #ffd700; margin-left: 20px;">
                            <li>✓ Elevated emotional state</li>
                            <li>✓ Deeper appreciation for your journey</li>
                            <li>✓ Strengthened relationships</li>
                            <li>✓ Renewed energy and motivation</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this Gratitude Session?</strong></p>
                    </div>
                    <textarea name="gratitude_title" placeholder="Give this gratitude session a meaningful title..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="backToSelection()">Back to Selection</button>
                    <button type="button" class="btn-primary" onclick="completeSession('gratitude')">Complete Session</button>
                </div>
            </div>

            <!-- HAPPY SESSION -->
            <div id="section-happy-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="happy-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Happy Session</h2>
                    <p>Step <span id="happy-step-number">1</span> of 8</p>
                </div>

                <div id="happy-step-1" class="stack-step">
                    <div style="background: rgba(76, 175, 80, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #4caf50; margin-bottom: 15px;">😊 Celebration Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Celebration Session helps you celebrate wins and extract wisdom from positive experiences. This 8-step process 
                            ensures you learn from success, maintain momentum, and amplify what's working in your life.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>You've achieved a win or breakthrough</li>
                            <li>Something wonderful has happened</li>
                            <li>Want to maintain positive momentum</li>
                            <li>Need to remind yourself of your progress</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #4caf50; margin-left: 20px;">
                            <li>✓ Deep appreciation of your success</li>
                            <li>✓ Clear understanding of what created the win</li>
                            <li>✓ Lessons to replicate success</li>
                            <li>✓ Renewed energy and motivation</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this Celebration Session?</strong></p>
                    </div>
                    <textarea name="happy_title" placeholder="Name this celebration..."></textarea>
                </div>

                <!-- ANGRY SESSION -->
            </div>

            <div id="section-angry-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="angry-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Angry Session</h2>
                    <p>Step <span id="angry-step-number">1</span> of 8</p>
                </div>

                <div id="angry-step-1" class="stack-step">
                    <div style="background: rgba(244, 67, 54, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #f44336; margin-bottom: 15px;">😤 Anger Processing Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Anger Processing session transforms rage and irritation into strategic action. This 8-step process helps you 
                            process negative emotions, separate facts from feelings, and create empowering narratives that serve your goals.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>Someone or something has triggered your anger</li>
                            <li>Feeling frustrated and need clarity</li>
                            <li>Want to convert destructive emotions into productive action</li>
                            <li>Need to reframe a situation strategically</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #f44336; margin-left: 20px;">
                            <li>✓ Release of emotional charge</li>
                            <li>✓ Clear distinction between facts and feelings</li>
                            <li>✓ New empowering story that serves you</li>
                            <li>✓ Strategic action plan from a place of power</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this processing session?</strong></p>
                    </div>
                    <textarea name="angry_title" placeholder="Name this processing session..."></textarea>
                </div>

                <!-- WAR SESSION -->
            </div>

            <div id="section-war-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="war-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>War/Action Session</h2>
                    <p>Step <span id="war-step-number">1</span> of 7</p>
                </div>

                <div id="war-step-1" class="stack-step">
                    <div style="background: rgba(255, 107, 107, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #ff6b6b; margin-bottom: 15px;">⚔️ WAR/Idea Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The WAR Session transforms productive ideas into actionable battle plans. This 7-step process helps you 
                            evaluate opportunities, identify obstacles, and create measurable facts (action steps) to execute your vision.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>You have a new business or life idea to develop</li>
                            <li>Need to turn inspiration into concrete action</li>
                            <li>Want to evaluate if an opportunity is worth pursuing</li>
                            <li>Ready to overcome obstacles and execute</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #ff6b6b; margin-left: 20px;">
                            <li>✓ Clear evaluation of your idea's potential</li>
                            <li>✓ Three specific, measurable action steps (FACTS)</li>
                            <li>✓ Identified obstacles with solutions</li>
                            <li>✓ Commitment to immediate execution</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this WAR/Idea Session?</strong></p>
                    </div>
                    <textarea name="war_title" placeholder="Give your idea a powerful title..."></textarea>
                </div>

                <!-- DISCOVER SESSION -->
            </div>

            <div id="section-discover-stack" class="form-section section-hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="discover-progress"></div>
                </div>
                
                <div class="step-indicator">
                    <h2>Discover Session</h2>
                    <p>Step <span id="discover-step-number">1</span> of 5</p>
                </div>

                <div id="discover-step-1" class="stack-step">
                    <div style="background: rgba(255, 193, 7, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #ffc107; margin-bottom: 15px;">🔍 Discovery Session Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Discovery Session extracts wisdom from learning experiences and turns insights into practical application. 
                            This 5-step process helps you capture revelations from books, training, conversations, or personal experiences.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>You've learned something significant from a book or course</li>
                            <li>Had an important realization or "aha" moment</li>
                            <li>Want to apply new knowledge to your life</li>
                            <li>Need to process and integrate learning</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Expected Outcomes:</strong></p>
                        <ul style="color: #ffc107; margin-left: 20px;">
                            <li>✓ Clear articulation of your discovery</li>
                            <li>✓ Understanding of why it matters to you</li>
                            <li>✓ Practical application to your Core 4 domains</li>
                            <li>✓ Immediate action steps to implement</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this Discovery Session?</strong></p>
                    </div>
                    <textarea name="discover_title" placeholder="Name this discovery session..."></textarea>
                </div>

                <!-- OPEN SESSION -->
            </div>

            <div id="section-open-stack" class="form-section section-hidden">
                <div class="step-indicator">
                    <h2>Open Session</h2>
                    <p>Freestyle Format</p>
                </div>

                <div class="stack-step">
                    <div style="background: rgba(156, 39, 176, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="color: #9c27b0; margin-bottom: 15px;">🌟 Open Format Purpose</h3>
                        <p style="color: #b8b8b8; line-height: 1.6; margin-bottom: 15px;">
                            The Open Format is your freestyle session for custom processing. This flexible approach lets you create 
                            your own structure for reflection, analysis, or any situation that doesn't fit the other session types.
                        </p>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>You'll use this when:</strong></p>
                        <ul style="color: #b8b8b8; margin-left: 20px; margin-bottom: 15px;">
                            <li>Need a "Working/Not Working" analysis</li>
                            <li>Want to do weekly or monthly reflection</li>
                            <li>Creating custom gratitude or growth sessions</li>
                            <li>Exploring something unique to your situation</li>
                        </ul>
                        <p style="color: #ffffff; margin-bottom: 10px;"><strong>Popular Formats:</strong></p>
                        <ul style="color: #9c27b0; margin-left: 20px;">
                            <li>✓ Working/Not Working Analysis</li>
                            <li>✓ Start/Stop/Continue Framework</li>
                            <li>✓ Weekly Wins & Lessons</li>
                            <li>✓ Gratitude and Growth Reflection</li>
                            <li>✓ Core 4 Domain Review</li>
                        </ul>
                    </div>
                    
                    <div class="question-prompt">
                        <p><strong>What are you going to title this Open Session?</strong></p>
                    </div>
                    <textarea name="open_title" placeholder="Name your freestyle session..."></textarea>
                    
                    <div class="question-prompt" style="margin-top: 30px;">
                        <p><strong>Time to freestyle. Share your thoughts...</strong></p>
                    </div>
                    <textarea name="open_content" style="min-height: 400px;" placeholder="Express yourself freely..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="backToSelection()">Back to Selection</button>
                    <button type="button" class="btn-primary" onclick="completeSession('open')">Complete Session</button>
                </div>
            </div>

            <!-- Completion Section -->
            <div id="section-completion" class="form-section section-hidden">
                <div class="completion-message">
                    <h2>🎉 Session Complete!</h2>
                    <p>Your session has been recorded and will be processed.</p>
                    <p>Thank you for taking the time to process and grow.</p>
                    
                    <div class="button-group" style="justify-content: center;">
                        <button type="button" class="btn-primary" onclick="startNewSession()">Start New Session</button>
                        <button type="button" class="btn-secondary" onclick="goBackToDashboard()">Return to Dashboard</button>
                    </div>
                </div>
            </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Transformation Sessions</h4>
                <p>Structured processing frameworks to transform thoughts into action and extract wisdom from every experience.</p>
            </div>
            <div class="footer-section">
                <h4>Quick Navigation</h4>
                <ul class="footer-links">
                    <li><a href="https://dvries10271.github.io/Coaching_Command_Center/">Main Dashboard</a></li>
                    <li><a href="https://dvries10271.github.io/Analytics-Dashboard/">Analytics Dashboard</a></li>
                    <li><a href="https://dvries10271.github.io/Action-Command-Center/">Action Center</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Session Types</h4>
                <ul class="footer-links">
                    <li><a href="#" onclick="selectStackType('prayer'); return false;">Prayer Session</a></li>
                    <li><a href="#" onclick="selectStackType('gratitude'); return false;">Gratitude Session</a></li>
                    <li><a href="#" onclick="selectStackType('happy'); return false;">Happy Session</a></li>
                    <li><a href="#" onclick="selectStackType('angry'); return false;">Anger Processing</a></li>
                    <li><a href="#" onclick="selectStackType('war'); return false;">War/Action Session</a></li>
                    <li><a href="#" onclick="selectStackType('discover'); return false;">Discovery Session</a></li>
                    <li><a href="#" onclick="selectStackType('open'); return false;">Open Format</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>System Status</h4>
                <div class="status-info" style="display: flex; align-items: center; gap: 0.5rem; color: rgba(255, 255, 255, 0.8); font-size: 0.9rem; margin-bottom: 0.5rem;">
                    <span class="status-dot" style="width: 8px; height: 8px; border-radius: 50%; background: #4caf50; animation: pulse 2s infinite;"></span>
                    <span>Session Module Active</span>
                </div>
                <div style="color: rgba(255, 255, 255, 0.5); font-size: 0.85rem;">
                    Auto-save: Enabled
                </div>
                <div style="color: rgba(255, 255, 255, 0.5); font-size: 0.85rem;" id="footerLastSave">
                    Last saved: Never
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2025 Lead Generation Experts LLC Coaching System. Built With Purpose. All Rights Reserved.</p>
            <p style="margin-top: 0.5rem; font-size: 0.8rem; color: rgba(255, 255, 255, 0.3);">Transformation Sessions v2.0 | Enhanced September 2025</p>
        </div>
    </footer>

    <script>
        // Configuration
        const stackConfigs = {
            prayer: { steps: 9, section: 'prayer-stack' },
            gratitude: { steps: 8, section: 'gratitude-stack' },
            happy: { steps: 8, section: 'happy-stack' },
            angry: { steps: 8, section: 'angry-stack' },
            war: { steps: 7, section: 'war-stack' },
            discover: { steps: 5, section: 'discover-stack' },
            open: { steps: 1, section: 'open-stack' }
        };

        let currentStack = null;
        let currentStep = {};

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Page loaded - initializing...');
            
            // Check for logged-in user
            checkUserAuthentication();
            
            // Initialize step trackers
            Object.keys(stackConfigs).forEach(stack => {
                currentStep[stack] = 1;
            });

            // Stack card selection
            document.querySelectorAll('.stack-card').forEach(card => {
                card.addEventListener('click', () => {
                    document.querySelectorAll('.stack-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    currentStack = card.dataset.stack;
                    document.getElementById('selected-stack').value = currentStack;
                    document.getElementById('start-stack-btn').disabled = false;
                    console.log(`Selected stack: ${currentStack}`);
                });
            });

            // Start button
            document.getElementById('start-stack-btn').addEventListener('click', () => {
                if (!validateRequiredFields()) {
                    return;
                }
                
                if (currentStack) {
                    console.log(`Starting ${currentStack} stack`);
                    document.getElementById('section-stack-selection').classList.add('section-hidden');
                    
                    const sectionId = `section-${stackConfigs[currentStack].section}`;
                    const section = document.getElementById(sectionId);
                    if (section) {
                        section.classList.remove('section-hidden');
                        console.log(`Showing section: ${sectionId}`);
                    } else {
                        console.log(`ERROR: Section not found: ${sectionId}`);
                    }
                }
            });

            console.log('Initialization complete');
        });

        function checkUserAuthentication() {
            const userEmail = localStorage.getItem('coaching_user_email');
            const userData = localStorage.getItem('coaching_user_data');
            
            if (userEmail && userData) {
                try {
                    const user = JSON.parse(userData);
                    console.log('User authenticated: ' + user.name);
                    
                    document.getElementById('manual-entry-form').style.display = 'none';
                    document.getElementById('logged-in-display').style.display = 'block';
                    document.getElementById('display-name').textContent = user.name || 'User';
                    document.getElementById('display-email').textContent = user.email || userEmail;
                    document.getElementById('user-name').value = user.name || 'User';
                    document.getElementById('user-email').value = user.email || userEmail;
                    document.getElementById('user-name').removeAttribute('required');
                    document.getElementById('user-email').removeAttribute('required');
                    document.getElementById('user-name').classList.remove('required-field');
                    document.getElementById('user-email').classList.remove('required-field');
                } catch (error) {
                    console.log('Error parsing user data: ' + error);
                    showManualEntry();
                }
            } else {
                console.log('No user authentication found');
                showManualEntry();
            }
        }

        function showManualEntry() {
            document.getElementById('manual-entry-form').style.display = 'block';
            document.getElementById('logged-in-display').style.display = 'none';
        }

        function validateRequiredFields() {
            const userEmail = localStorage.getItem('coaching_user_email');
            const userData = localStorage.getItem('coaching_user_data');
            
            if (userEmail && userData) {
                console.log('User authenticated - skipping name/email validation');
                return true;
            }
            
            const requiredFields = document.querySelectorAll('.required-field');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    isValid = false;
                    field.style.borderColor = '#ff4336';
                }
            });
            
            if (!isValid) {
                const errorMsg = document.getElementById('error-message');
                if (errorMsg) {
                    errorMsg.style.display = 'block';
                }
                console.log('Validation failed');
            }
            
            return isValid;
        }

        function goBackToDashboard() {
            window.location.href = 'https://dvries10271.github.io/Coaching_Command_Center/';
        }

        function backToSelection() {
            console.log('Returning to session selection');
            document.querySelectorAll('.form-section').forEach(section => {
                section.classList.add('section-hidden');
            });
            document.getElementById('section-stack-selection').classList.remove('section-hidden');
        }

        function completeSession(sessionType) {
            console.log(`Completing ${sessionType} session`);
            
            // Hide current section
            document.getElementById(`section-${stackConfigs[sessionType].section}`).classList.add('section-hidden');
            
            // Show completion
            document.getElementById('section-completion').classList.remove('section-hidden');
        }

        function selectStackType(stackType) {
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Deselect all cards
            document.querySelectorAll('.stack-card').forEach(c => c.classList.remove('selected'));
            
            // Select the specific card
            const targetCard = document.querySelector(`[data-stack="${stackType}"]`);
            if (targetCard) {
                targetCard.classList.add('selected');
                currentStack = stackType;
                document.getElementById('selected-stack').value = stackType;
                document.getElementById('start-stack-btn').disabled = false;
                console.log(`Selected stack via footer: ${stackType}`);
            }
        }

        function startNewSession() {
            console.log('Starting new session');
            
            // Reset everything
            currentStack = null;
            Object.keys(stackConfigs).forEach(stack => {
                currentStep[stack] = 1;
            });
            document.getElementById('selected-stack').value = '';
            document.getElementById('start-stack-btn').disabled = true;
            document.querySelectorAll('.stack-card').forEach(c => c.classList.remove('selected'));
            
            // Clear textareas
            document.querySelectorAll('textarea').forEach(t => {
                t.value = '';
            });
            
            // Show selection screen
            document.getElementById('section-completion').classList.add('section-hidden');
            document.getElementById('section-stack-selection').classList.remove('section-hidden');
        }
    </script>
</body>
</html>
